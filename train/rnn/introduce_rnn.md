# RNNä»‹ç»

âŒšï¸: 2021-07-21

ðŸ“šå‚è€ƒ

- [ä»€ä¹ˆæ˜¯transformerï¼Ÿã€çŸ¥å¤šå°‘ã€‘](https://www.bilibili.com/video/BV1Zz4y127h1)

- [ä»€ä¹ˆæ˜¯å¾ªçŽ¯ç¥žç»ç½‘ç»œRNNï¼Ÿã€çŸ¥å¤šå°‘ã€‘](https://www.bilibili.com/video/BV1Zi4y1L7LL/?spm_id_from=333.788.recommend_more_video.-1)
- [ä»€ä¹ˆæ˜¯é•¿çŸ­æ—¶è®°å¿†ç½‘ç»œLSTMï¼Ÿã€çŸ¥å¤šå°‘ã€‘](https://www.bilibili.com/video/BV1gy4y1q7M5/?spm_id_from=333.788.recommend_more_video.0)
- [ä»€ä¹ˆæ˜¯ BERTï¼Ÿã€çŸ¥å¤šå°‘ã€‘](https://www.bilibili.com/video/BV11N41197nq/?spm_id_from=trigger_reload)
- [ä»€ä¹ˆæ˜¯ GPTï¼Ÿã€çŸ¥å¤šå°‘ã€‘](https://www.bilibili.com/video/BV1Jv411a7RB/?spm_id_from=trigger_reload)
- [ä»€ä¹ˆæ˜¯ Attentionï¼ˆæ³¨æ„åŠ›æœºåˆ¶ï¼‰ï¼Ÿã€çŸ¥å¤šå°‘ã€‘](https://www.bilibili.com/video/BV1G64y1S7bc)



---

## 0ã€NLP-å­¦ä¹ è·¯çº¿

![image-20210721201512490](imgs/image-20210721201512490.png)

![image-20210721203146931](imgs/image-20210721203146931.png)

![image-20210721203426655](imgs/image-20210721203426655.png)

#### ï¼ˆ1ï¼‰ä»€ä¹ˆæ˜¯å¾ªçŽ¯ç¥žç»ç½‘ç»œRNNï¼Ÿ

åœ¨è¯†åˆ«å›¾åƒæ—¶ï¼Œè¾“å…¥çš„æ¯å¼ å›¾ç‰‡éƒ½æ˜¯å­¤ç«‹çš„ï¼Œè®¤å‡ºè¿™å¼ å›¾ç‰‡æ˜¯è‹¹æžœï¼Œå¹¶ä¸ä¼šå¯¹è®¤å‡ºä¸‹ä¸€å¼ å›¾ç‰‡æ˜¯æ¢¨é€ æˆå½±å“ã€‚

ä½†å¯¹äºŽè¯­è¨€æ¥è¯´ï¼Œé¡ºåºæ˜¯ååˆ†é‡è¦çš„ï¼Œ[æˆ‘åƒè‹¹æžœ]å’Œ[è‹¹æžœåƒæˆ‘]ï¼Œè¯è¯­é¡ºåºçš„æ”¹å˜è¡¨è¾¾äº†å®Œå…¨ä¸åŒçš„æ„ä¹‰ï¼Œé¡ºåºä¹Ÿæä¾›äº†ä¸€å®šçš„ä¿¡æ¯ï¼Œæ¯”å¦‚[åƒ]åŽé¢ï¼Œå¤§æ¦‚çŽ‡æ˜¯ä»£è¡¨é£Ÿç‰©çš„åè¯ã€‚

ä¸ºäº†æ•æ‰æ•°æ®çš„è¿™ç§å…³è”ï¼Œäººä»¬æ‰¾åˆ°äº†RNNï¼Œä¸€ä¸ªé«˜åº¦é‡è§†åºåˆ—ä¿¡æ¯çš„ç½‘ç»œï¼Œåºåˆ—å°±æ˜¯æ•°æ®çš„å‰åŽå…³ç³»ã€‚

RNNçš„åŸºç¡€ä»ç„¶æ˜¯ç¥žç»ç½‘ç»œï¼Œåªä¸è¿‡å®ƒå¤šäº†ä¸€ä¸ªå°ç›’å­ï¼Œç”¨æ¥è®°å½•æ•°æ®è¾“å…¥æ—¶ç½‘ç»œçš„çŠ¶æ€ï¼Œåœ¨ä¸‹ä¸€æ¬¡è¾“å…¥æ•°æ®æ—¶ï¼Œç½‘ç»œå¿…é¡»è¦è€ƒè™‘å°ç›’å­ä¸­ä¿å­˜çš„ä¿¡æ¯ï¼Œéšç€æ•°æ®çš„ä¸€æ¬¡æ¬¡è¾“å…¥ï¼Œå­˜å‚¨çš„ä¿¡æ¯ä¹Ÿåœ¨ä¸æ–­æ›´æ–°ï¼Œç›’å­ä¸­çš„ä¿¡æ¯è¢«ç§°ä¸ºéšçŠ¶æ€ã€‚

å’Œå¼€å§‹ä¸¾å‡ºçš„ä¾‹å­ä¸€æ ·ï¼ŒRNNæœ€å¸¸è§çš„é¢†åŸŸå°±æ˜¯è‡ªç„¶è¯­è¨€å¤„ç†ï¼Œæœºå™¨ç¿»è¯‘æ˜¯å¯»æ‰¾ç›¸åŒçš„æ„ä¹‰åºåˆ—åœ¨ä¸åŒè¯­è¨€ä¸­çš„è¡¨è¾¾ï¼Œè¯—æ­Œç”Ÿæˆæ˜¯åŸºäºŽä¸€ä¸ªä¸»é¢˜ï¼ŒæŒ‰ç…§ä¸€å®šçš„è§„åˆ™è¾“å‡ºæœ‰é€»è¾‘çš„è¯è¯­åºåˆ—ï¼Œæ”¹å˜ä¸¤ç«¯çš„æ•°æ®ç±»åž‹ï¼Œè¾“å…¥å›¾ç‰‡è¾“å‡ºå¥å­ï¼Œå°±æ˜¯çœ‹å›¾è¯´è¯ï¼Œè¯­éŸ³åŒæ ·å¯ä»¥çœ‹åšå£°éŸ³ä¿¡å·æŒ‰æ—¶é—´é¡ºåºç»„æˆçš„åºåˆ—ï¼Œè¯­éŸ³è¯†åˆ«å’Œè¯­éŸ³ç”ŸæˆåŒæ ·åœ¨RNNçš„èƒ½åŠ›èŒƒå›´å†…ï¼Œè‚¡ç¥¨ä»·æ ¼ä¹Ÿå¯ä»¥çœ‹åšä¸€ä¸ªå—æ—¶é—´å½±å“çš„åºåˆ—ï¼Œå¾ˆå¤šé‡åŒ–äº¤æ˜“æ¨¡åž‹çš„å»ºç«‹ï¼Œå°±æ˜¯åŸºäºŽè¿™æ ·çš„è®¤çŸ¥ã€‚

ä¸è¿‡RNNä»æœ‰ä¸å¯å¿½è§†çš„ç¼ºé™·ï¼Œæ•°æ®è¾“å…¥çš„è¶Šæ—©ï¼Œåœ¨éšçŠ¶æ€ä¸­å æ®çš„å½±å“è¶Šå°ï¼Œä¹Ÿå°±æ˜¯è¯´ä¸€ä¸ªå¥å­å¦‚æžœå¾ˆé•¿ï¼ŒRNNå°±ä¼šå¿˜è®°å¼€å§‹æ—¶è¯´äº†ä»€ä¹ˆï¼ŒäºŽæ˜¯å°±æœ‰äº†RNNçš„æ”¹è‰¯ç‰ˆï¼ŒLSTMé•¿çŸ­æ—¶è®°å¿†æ¨¡åž‹ã€‚

#### ï¼ˆ2ï¼‰ä»€ä¹ˆæ˜¯é•¿çŸ­æ—¶è®°å¿†ç½‘ç»œLSTMï¼Ÿ

RNNå…·æœ‰ä¸€å®šçš„è®°å¿†èƒ½åŠ›ï¼Œä¸å¹¸çš„æ˜¯å®ƒåªèƒ½ä¿ç•™çŸ­æœŸè®°å¿†ï¼Œåœ¨å„ç±»ä»»åŠ¡ä¸Šè¡¨çŽ°å¹¶ä¸å¥½ï¼Œé‚£è¯¥æ€Žä¹ˆåŠžï¼Ÿ

äººä»¬å°†ç›®å…‰æŠ•å‘äº†è‡ªå·±ï¼Œäººç±»çš„è®°å¿†æ˜¯æœ‰å–èˆçš„ï¼Œæˆ‘ä»¬ä¸ä¼šè®°ä½æ¯æ—¶æ¯åˆ»å‘ç”Ÿçš„æ‰€æœ‰äº‹ï¼Œä¼šæœ‰é€‰æ‹©çš„ç•™ä¸‹[é‡è¦çš„]ï¼Œä¸¢æŽ‰[ä¸é‡è¦çš„]ï¼Œå‚è€ƒè¿™ç§è®°å¿†æœºåˆ¶ï¼Œäººä»¬æ”¹é€ äº†å°ç›’å­ï¼Œå¹¶æ‰¾åˆ°äº†"é—¨"è¿™ç§æœºåˆ¶ã€‚

é—¨æ˜¯ç”¨æ¥å†³å®šä¿¡æ¯å¦‚ä½•ä¿ç•™çš„å°å¼€å…³ï¼Œå®ƒçš„æ•°å€¼åœ¨0åˆ°1ä¹‹é—´ï¼Œ1æ˜¯å®Œå…¨ä¿ç•™ï¼Œ0æ˜¯å®Œå…¨èˆå¼ƒï¼Œæ–°çš„å°ç›’å­ä¸Šè¿˜æœ‰ä¸‰ä¸ªé—¨ï¼Œå…¶ä¸­é—å¿˜é—¨å†³å®šäº†å°ç›’å­é‡Œè¦ä¿ç•™å¤šå°‘åŽŸæœ‰ä¿¡æ¯ï¼Œä¹Ÿå°±æ˜¯ä¸¢æŽ‰å“ªäº›ä¸é‡è¦çš„è®°å¿†ï¼Œè¾“å…¥é—¨å†³å®šå½“å‰ç½‘ç»œä¿¡æ¯æœ‰å¤šå°‘è¦è¢«ä¿ç•™åˆ°å°ç›’å­é‡Œï¼Œä¹Ÿå°±æ˜¯è®°ä½å“ªäº›æ–°ä¸œè¥¿ï¼Œè¾“å‡ºé—¨å†³å®šäº†å¤šå¤§ç¨‹åº¦åœ°è¾“å‡ºå°ç›’å­ä¸­çš„ä¿¡æ¯ï¼Œç»è¿‡æ”¹é€ çš„å°ç›’å­ï¼Œæ—¢èƒ½é€šè¿‡è¾“å…¥é—¨å¯¹å½“å‰ç½‘ç»œçš„çŠ¶æ€æœ‰æ‰€äº†è§£ï¼Œåˆèƒ½åˆ©ç”¨é—å¿˜é—¨ç•™ä¸‹è¿‡å¾€çš„é‡è¦ä¿¡æ¯ï¼Œè¿™å°±æ˜¯LSTMï¼Œé•¿çŸ­æ—¶è®°å¿†æ¨¡åž‹ã€‚

é€šè¿‡æ”¹å˜å°ç›’å­çš„ç»“æž„ï¼ŒLSTMè¿˜æœ‰å¾ˆå¤šå˜ä½“å¦‚MGU,SRUï¼Œä¸è¿‡æœ€å—æ¬¢è¿Žçš„è¿˜æ˜¯é—¨æŽ§å¾ªçŽ¯å•å…ƒGRUï¼ŒGRUåªæœ‰ä¸¤ä¸ªé—¨ï¼Œæ›´æ–°é—¨æ˜¯è¾“å…¥é—¨åˆå…¥é—å¿˜é—¨çš„ç»“åˆä½“ï¼Œå†³å®šä¸¢å¼ƒå“ªäº›æ—§ä¿¡æ¯ï¼Œæ·»åŠ å“ªäº›æ–°ä¿¡æ¯ï¼Œé‡ç½®é—¨å†³å®šå†™å…¥å¤šå°‘ä¸Šä¸€æ—¶åˆ»ç½‘ç»œçš„çŠ¶æ€ï¼Œç”¨æ¥æ•æ‰çŸ­æœŸè®°å¿†ï¼Œç»“æž„æ›´ç®€æ´ï¼Œè®¡ç®—æ›´é«˜æ•ˆï¼Œæ•ˆæžœåˆä¸ŽLSTMä¸ç›¸ä¸Šä¸‹ï¼ŒGRUæ­£å˜å¾—è¶Šæ¥è¶Šæµè¡Œã€‚

#### ï¼ˆ3ï¼‰ä»€ä¹ˆæ˜¯seq2seqï¼Ÿä»€ä¹ˆæ˜¯attensionã€self-attentionï¼Ÿä»€ä¹ˆæ˜¯Transformerï¼Ÿ

å¤„ç†æœºå™¨ç¿»è¯‘ä»»åŠ¡æ—¶ï¼Œç”¨ä»€ä¹ˆæ¨¡åž‹æ¯”è¾ƒå¥½ï¼ŸRNNæ˜¯ä¸ªä¸é”™çš„é€‰æ‹©ï¼Œå•è¯çš„å…ˆåŽé¡ºåºä¼šå½±å“å¥å­çš„æ„ä¹‰ï¼Œæ“…é•¿æ•æ‰åºåˆ—å…³ç³»çš„å®ƒéžå¸¸åˆé€‚ï¼Œä½†æ˜¯å¯¹äºŽç¿»è¯‘æ¥è¯´ï¼Œå¥å­é—´çš„å•è¯æ•°é‡å¹¶éžæ˜¯ä¸€ä¸€å¯¹åº”çš„ï¼Œå—é™äºŽç»“æž„ï¼ŒRNNåªèƒ½å®žçŽ°N to Nï¼Œ1 to Næˆ–è€… N to 1ï¼Œå¯¹äºŽè¿™ç§N to Mçš„é—®é¢˜å¾ˆæ˜¯å¤´ç–¼(?why?)

é‚£è¯¥æ€Žä¹ˆåŠžï¼Œäººä»¬æ‰¾åˆ°äº†Seq2Seqï¼Œä¸€ä¸ªæ‹¥æœ‰ç¼–ç å™¨(Encoder)å’Œè§£ç å™¨(Decoder)çš„æ¨¡åž‹ï¼ŒEncoderå’ŒDecoderä¾ç„¶æ˜¯RNNç½‘ç»œï¼Œä¸è¿‡è¿™æ¬¡å…ˆç”±Encoderæå–åŽŸå§‹å¥å­çš„æ„ä¹‰ï¼Œå†ç”±Decoderå°†æ„ä¹‰è½¬æ¢æˆå¯¹åº”çš„è¯­è¨€ï¼Œä¾é æ„ä¹‰è¿™ä¸€[ä¸­ä»‹]ï¼ŒSeq2SeqæˆåŠŸè§£å†³äº†ä¸¤ç«¯å•è¯æ•°ä¸å¯¹ç­‰çš„çŠ¶å†µï¼Œ

æ–°çš„é—®é¢˜åˆå‡ºçŽ°äº†ï¼Œæ„ä¹‰å•å…ƒèƒ½å¤Ÿå­˜å‚¨çš„ä¿¡æ¯æ˜¯æœ‰é™çš„ï¼Œå¦‚æžœä¸€ä¸ªå¥å­å¤ªé•¿ï¼Œç¿»è¯‘ç²¾åº¦å°±ä¼šéšä¹‹ä¸‹é™ï¼ŒäºŽæ˜¯äººä»¬æ‰¾åˆ°äº†Attentionï¼Œæ³¨æ„åŠ›æœºåˆ¶ï¼Œåœ¨Seq2Seqçš„åŸºç¡€ç»“æž„ä¸Šï¼Œç”Ÿæˆæ¯ä¸ªå•è¯æ—¶ï¼Œéƒ½æœ‰æ„è¯†åœ°ä»ŽåŽŸå§‹å¥å­æå–ç”Ÿæˆè¯¥å•è¯æœ€é‡è¦çš„ä¿¡æ¯ï¼ŒæˆåŠŸæ‘†è„±äº†è¾“å…¥åºåˆ—çš„é•¿åº¦é™åˆ¶ã€‚

æŽ¥ä¸‹æ¥çš„é—®é¢˜æ˜¯ï¼Œè¿™æ ·çš„è®¡ç®—æ–¹å¼å¤ªæ…¢äº†ï¼ŒRNNéœ€è¦é€ä¸ªçœ‹è¿‡å¥å­ä¸­çš„å•è¯ï¼Œæ‰èƒ½ç»™å‡ºè¾“å‡ºï¼Œæ—¢ç„¶Attentionè¿™ä¹ˆå¥½ç”¨ï¼Œäººä»¬å°±è¿›ä¸€æ­¥æ‰¾åˆ°äº†Self-Attentionï¼Œè‡ªæ³¨æ„æœºåˆ¶ï¼Œå…ˆæå–æ¯ä¸ªå•è¯çš„æ„ä¹‰ï¼Œå†ä¾æ®ç”Ÿæˆé¡ºåºé€‰å–æ‰€éœ€è¦çš„ä¿¡æ¯ï¼Œè¿™æ ·çš„ç»“æž„ä¸æ­¢æ”¯æŒå¹¶è¡Œè®¡ç®—ï¼Œæ•ˆçŽ‡æ›´é«˜ï¼Œä¹Ÿå¾ˆæŽ¥è¿‘äººç±»çš„ç¿»è¯‘æ–¹å¼ï¼Œæ•ˆæžœå¥½åˆ°æ²¡è¯è¯´ã€‚

åˆ°è¿™é‡Œï¼Œæ¨¡åž‹ä»¥åŠè„±ç¦»äº†æœ€åˆçš„RNNï¼Œæˆä¸ºäº†ä¸€ä¸ªå®Œå…¨åŸºäºŽè‡ªæ³¨æ„åŠ›æœºåˆ¶çš„æ‹¥æœ‰Encoderå’ŒDecoderçš„ç»“æž„ï¼Œè¿™å°±æ˜¯Transformerï¼Œä¸æ­¢æ˜¯æœºå™¨ç¿»è¯‘ï¼ŒTransformeræ¨ªæ‰«è‡ªç„¶è¯­è¨€å¤„ç†é¢†åŸŸã€‚

#### ï¼ˆ4ï¼‰ä»€ä¹ˆæ˜¯BERTï¼Ÿ

TODO

#### ï¼ˆ5ï¼‰ä»€ä¹ˆæ˜¯GPTï¼Ÿ

TODO

## 1ã€RNN

### 1.1 RNNç½‘ç»œç»“æž„

åœ¨å‰é¢è®²åˆ°çš„DNNå’ŒCNNä¸­ï¼Œè®­ç»ƒæ ·æœ¬çš„è¾“å…¥å’Œè¾“å‡ºæ˜¯æ¯”è¾ƒçš„ç¡®å®šçš„ã€‚ä½†æ˜¯æœ‰ä¸€ç±»é—®é¢˜DNNå’ŒCNNä¸å¥½è§£å†³ï¼Œå°±æ˜¯è®­ç»ƒæ ·æœ¬è¾“å…¥æ˜¯è¿žç»­çš„åºåˆ—,ä¸”åºåˆ—çš„é•¿çŸ­ä¸ä¸€ï¼Œæ¯”å¦‚åŸºäºŽæ—¶é—´çš„åºåˆ—ï¼šä¸€æ®µæ®µè¿žç»­çš„è¯­éŸ³ï¼Œä¸€æ®µæ®µè¿žç»­çš„æ‰‹å†™æ–‡å­—ã€‚è¿™äº›åºåˆ—æ¯”è¾ƒé•¿ï¼Œä¸”é•¿åº¦ä¸ä¸€ï¼Œæ¯”è¾ƒéš¾ç›´æŽ¥çš„æ‹†åˆ†æˆä¸€ä¸ªä¸ªç‹¬ç«‹çš„æ ·æœ¬æ¥é€šè¿‡DNN/CNNè¿›è¡Œè®­ç»ƒã€‚

![](imgs/1.png)

![](imgs/2.png)

### 1.2 RNNå‰å‘ä¼ æ’­ç®—æ³•

![](imgs/3.png)

### 1.3 RNNåå‘ä¼ æ’­ç®—æ³•æŽ¨å¯¼

æœ‰äº†RNNå‰å‘ä¼ æ’­ç®—æ³•çš„åŸºç¡€ï¼Œå°±å®¹æ˜“æŽ¨å¯¼å‡ºRNNåå‘ä¼ æ’­ç®—æ³•çš„æµç¨‹äº†ã€‚RNNåå‘ä¼ æ’­ç®—æ³•çš„æ€è·¯å’ŒDNNæ˜¯ä¸€æ ·çš„ï¼Œå³é€šè¿‡æ¢¯åº¦ä¸‹é™æ³•ä¸€è½®è½®çš„è¿­ä»£ï¼Œå¾—åˆ°åˆé€‚çš„RNNæ¨¡åž‹å‚æ•°`ð‘ˆ,ð‘Š,ð‘‰,ð‘,ð‘U,W,V,b,c`ã€‚ç”±äºŽæˆ‘ä»¬æ˜¯åŸºäºŽæ—¶é—´åå‘ä¼ æ’­ï¼Œæ‰€ä»¥RNNçš„åå‘ä¼ æ’­æœ‰æ—¶ä¹Ÿå«åšBPTT(back-propagation through time)ã€‚å½“ç„¶è¿™é‡Œçš„BPTTå’ŒDNNä¹Ÿæœ‰å¾ˆå¤§çš„ä¸åŒç‚¹ï¼Œå³è¿™é‡Œæ‰€æœ‰çš„ð‘ˆ,ð‘Š,ð‘‰,ð‘,ð‘U,W,V,b,cåœ¨åºåˆ—çš„å„ä¸ªä½ç½®æ˜¯å…±äº«çš„ï¼Œåå‘ä¼ æ’­æ—¶æˆ‘ä»¬æ›´æ–°çš„æ˜¯ç›¸åŒçš„å‚æ•°ã€‚

ä¸ºäº†ç®€åŒ–æè¿°ï¼Œè¿™é‡Œçš„æŸå¤±å‡½æ•°æˆ‘ä»¬ä¸ºäº¤å‰ç†µæŸå¤±å‡½æ•°ï¼Œè¾“å‡ºçš„æ¿€æ´»å‡½æ•°ä¸ºsoftmaxå‡½æ•°ï¼Œéšè—å±‚çš„æ¿€æ´»å‡½æ•°ä¸ºtanhå‡½æ•°ã€‚

å¯¹äºŽRNNï¼Œç”±äºŽæˆ‘ä»¬åœ¨åºåˆ—çš„æ¯ä¸ªä½ç½®éƒ½æœ‰æŸå¤±å‡½æ•°ï¼Œå› æ­¤æœ€ç»ˆçš„æŸå¤±ð¿ä¸ºï¼š

![](imgs/4.png)

### 1.4 RNNå°ç»“

ã€€ã€€ã€€ã€€ä¸Šé¢æ€»ç»“äº†é€šç”¨çš„RNNæ¨¡åž‹å’Œå‰å‘åå‘ä¼ æ’­ç®—æ³•ã€‚å½“ç„¶ï¼Œæœ‰äº›RNNæ¨¡åž‹ä¼šæœ‰äº›ä¸åŒï¼Œè‡ªç„¶å‰å‘åå‘ä¼ æ’­çš„å…¬å¼ä¼šæœ‰äº›ä¸ä¸€æ ·ï¼Œä½†æ˜¯åŽŸç†åŸºæœ¬ç±»ä¼¼ã€‚

ã€€ã€€ã€€ã€€RNNè™½ç„¶ç†è®ºä¸Šå¯ä»¥å¾ˆæ¼‚äº®çš„è§£å†³åºåˆ—æ•°æ®çš„è®­ç»ƒï¼Œä½†æ˜¯å®ƒä¹ŸåƒDNNä¸€æ ·æœ‰æ¢¯åº¦æ¶ˆå¤±æ—¶çš„é—®é¢˜ï¼Œå½“åºåˆ—å¾ˆé•¿çš„æ—¶å€™é—®é¢˜å°¤å…¶ä¸¥é‡ã€‚å› æ­¤ï¼Œä¸Šé¢çš„RNNæ¨¡åž‹ä¸€èˆ¬ä¸èƒ½ç›´æŽ¥ç”¨äºŽåº”ç”¨é¢†åŸŸã€‚åœ¨è¯­éŸ³è¯†åˆ«ï¼Œæ‰‹å†™ä¹¦åˆ«ä»¥åŠæœºå™¨ç¿»è¯‘ç­‰NLPé¢†åŸŸå®žé™…åº”ç”¨æ¯”è¾ƒå¹¿æ³›çš„æ˜¯åŸºäºŽRNNæ¨¡åž‹çš„ä¸€ä¸ªç‰¹ä¾‹LSTMï¼Œä¸‹ä¸€ç¯‡æˆ‘ä»¬å°±æ¥è®¨è®ºLSTMæ¨¡åž‹ã€‚

è¿™é‡Œæ‰€æœ‰çš„U,W,V,b,cåœ¨åºåˆ—çš„å„ä¸ªä½ç½®æ˜¯å…±äº«çš„ï¼Œæ‰€ä»¥åå‘ä¼ æ’­æ—¶æˆ‘ä»¬æ›´æ–°çš„æ˜¯ç›¸åŒçš„å‚æ•°ï¼Œå¯ä»¥åˆ©ç”¨æ¢¯åº¦ä¸‹é™æ³•ä¸æ–­æ›´æ–°å‚æ•°

å½“ç„¶ï¼Œè¿™é‡Œæ‰€è¯´çš„å‚æ•°å…±äº«æ˜¯æŒ‡å¯¹äºŽæ¯ä¸€ä¸ªç¥žç»å…ƒçš„å‚æ•°ã€‚å¯¹äºŽä¸åŒçš„ç¥žç»å…ƒçš„å‚æ•°ï¼Œä¹‹é—´æ˜¯ç›¸äº’ç‹¬ç«‹çš„ã€‚

å¯ä»¥çœ‹å‡ºåœ¨æ•´ä¸ªè¿‡ç¨‹ä¸­åªæœ‰éšè—å±‚çŠ¶æ€håœ¨ä¸æ–­çš„ä»Žå‰å‘åŽä¼ ï¼Œä¸æ–­çš„ç»§æ‰¿å‰é¢çš„ä¿¡æ¯ã€‚

é‚£ä¹ˆï¼Œç”±äºŽåœ¨ä¸æ–­å¾ªçŽ¯çš„è¿‡ç¨‹ä¸­ï¼Œéšè—çŠ¶æ€hä¼šä¸æ–­çš„å’Œå‚æ•°çŸ©é˜µWç›¸ä¹˜ï¼Œé‚£å°±å¿…ç„¶ä¼šé¢ä¸´æ¢¯åº¦æ¶ˆå¤±å’Œæ¢¯åº¦çˆ†ç‚¸çš„é—®é¢˜ã€‚æ¢¯åº¦æ¶ˆå¤±å¾ˆå®¹æ˜“ç†è§£ï¼Œå¯ä»¥çœ‹åšæ˜¯è¶Šæ—©çš„ä¿¡æ¯å¯¹å½“å‰çš„è´¡çŒ®è¶Šå°ã€‚æ‰€ä»¥RNNæ— æ³•è®°ä½å¾ˆå¤šä¿¡æ¯ã€‚ç‰¹åˆ«æ˜¯æ—¶é—´è·ç¦»è¾ƒè¿œçš„ä¿¡æ¯ã€‚

## 2ã€LSTM

æ¢¯åº¦æ¶ˆå¤±å’Œæ¢¯åº¦çˆ†ç‚¸æ˜¯å›°æ‰°RNNæ¨¡åž‹è®­ç»ƒçš„å…³é”®åŽŸå› ä¹‹ä¸€ï¼Œäº§ç”Ÿæ¢¯åº¦æ¶ˆå¤±å’Œæ¢¯åº¦çˆ†ç‚¸æ˜¯ç”±äºŽRNNçš„æƒå€¼çŸ©é˜µå¾ªçŽ¯ç›¸ä¹˜å¯¼è‡´çš„ï¼Œç›¸åŒå‡½æ•°çš„å¤šæ¬¡ç»„åˆä¼šå¯¼è‡´æžç«¯çš„éžçº¿æ€§è¡Œä¸ºã€‚æ¢¯åº¦æ¶ˆå¤±å’Œæ¢¯åº¦çˆ†ç‚¸ä¸»è¦å­˜åœ¨RNNä¸­ï¼Œå› ä¸ºRNNä¸­æ¯ä¸ªæ—¶é—´ç‰‡ä½¿ç”¨ç›¸åŒçš„æƒå€¼çŸ©é˜µã€‚å¯¹äºŽä¸€ä¸ªDNNï¼Œè™½ç„¶ä¹Ÿæ¶‰åŠå¤šä¸ªçŸ©é˜µçš„ç›¸ä¹˜ï¼Œä½†æ˜¯é€šè¿‡ç²¾å¿ƒè®¾è®¡æƒå€¼çš„æ¯”ä¾‹å¯ä»¥é¿å…æ¢¯åº¦æ¶ˆå¤±å’Œæ¢¯åº¦çˆ†ç‚¸çš„é—®é¢˜ .

å¤„ç†æ¢¯åº¦çˆ†ç‚¸å¯ä»¥é‡‡ç”¨æ¢¯åº¦æˆªæ–­çš„æ–¹æ³•ã€‚æ‰€è°“æ¢¯åº¦æˆªæ–­æ˜¯æŒ‡å°†æ¢¯åº¦å€¼è¶…è¿‡é˜ˆå€¼ ![[å…¬å¼]](https://www.zhihu.com/equation?tex=%5Ctheta) çš„æ¢¯åº¦æ‰‹åŠ¨é™åˆ° ![[å…¬å¼]](https://www.zhihu.com/equation?tex=%5Ctheta) ã€‚è™½ç„¶æ¢¯åº¦æˆªæ–­ä¼šä¸€å®šç¨‹åº¦ä¸Šæ”¹å˜æ¢¯åº¦çš„æ–¹å‘ï¼Œä½†æ¢¯åº¦æˆªæ–­çš„æ–¹å‘ä¾æ—§æ˜¯æœå‘æŸå¤±å‡½æ•°å‡å°çš„æ–¹å‘ã€‚

å¯¹æ¯”æ¢¯åº¦çˆ†ç‚¸ï¼Œæ¢¯åº¦æ¶ˆå¤±ä¸èƒ½ç®€å•çš„é€šè¿‡ç±»ä¼¼æ¢¯åº¦æˆªæ–­çš„é˜ˆå€¼å¼æ–¹æ³•æ¥è§£å†³ï¼Œå› ä¸ºé•¿æœŸä¾èµ–çš„çŽ°è±¡ä¹Ÿä¼šäº§ç”Ÿå¾ˆå°çš„æ¢¯åº¦ã€‚

ä¸ºäº†è§£å†³æ¢¯åº¦æ¶ˆå¤±çš„é—®é¢˜ï¼Œå¤§ä½¬ä»¬æ”¹è¿›äº†RNNè®¾è®¡äº†LSTMæ¨¡åž‹ç»“æž„

> LSTMçš„å…¨ç§°æ˜¯Long Short Term Memoryï¼Œé¡¾åæ€ä¹‰ï¼Œå®ƒå…·æœ‰è®°å¿†é•¿çŸ­æœŸä¿¡æ¯çš„èƒ½åŠ›çš„ç¥žç»ç½‘ç»œã€‚LSTMé¦–å…ˆåœ¨1997å¹´ç”±Hochreiter & Schmidhuber [1] æå‡ºï¼Œç”±äºŽæ·±åº¦å­¦ä¹ åœ¨2012å¹´çš„å…´èµ·ï¼ŒLSTMåˆç»è¿‡äº†è‹¥å¹²ä»£å¤§ç‰›(Felix Gers, Fred Cummins, Santiago Fernandez, Justin Bayer, Daan Wierstra, Julian Togelius, Faustino Gomez, Matteo Gagliolo, and Alex Gloves)çš„å‘å±•ï¼Œç”±æ­¤ä¾¿å½¢æˆäº†æ¯”è¾ƒç³»ç»Ÿä¸”å®Œæ•´çš„LSTMæ¡†æž¶ï¼Œå¹¶ä¸”åœ¨å¾ˆå¤šé¢†åŸŸå¾—åˆ°äº†å¹¿æ³›çš„åº”ç”¨ã€‚
>

LSTMæå‡ºçš„åŠ¨æœºæ˜¯ä¸ºäº†è§£å†³é•¿æœŸä¾èµ–é—®é¢˜ã€‚ä¼ ç»Ÿçš„RNNèŠ‚ç‚¹è¾“å‡ºä»…ç”±æƒå€¼ï¼Œåç½®ä»¥åŠæ¿€æ´»å‡½æ•°å†³å®šã€‚RNNæ˜¯ä¸€ä¸ªé“¾å¼ç»“æž„ï¼Œæ¯ä¸ªæ—¶é—´ç‰‡ä½¿ç”¨çš„æ˜¯ç›¸åŒçš„å‚æ•°ã€‚

![](imgs/5.png)

![](imgs/6.png)

![](imgs/17.jpg)

### 2.1 LSTMæ¨¡åž‹ç»“æž„å‰–æž

ã€€ã€€ã€€ã€€ä¸Šé¢æˆ‘ä»¬ç»™å‡ºäº†LSTMçš„æ¨¡åž‹ç»“æž„ï¼Œä¸‹é¢æˆ‘ä»¬å°±ä¸€ç‚¹ç‚¹çš„å‰–æžLSTMæ¨¡åž‹åœ¨æ¯ä¸ªåºåˆ—ç´¢å¼•ä½ç½®tæ—¶åˆ»çš„å†…éƒ¨ç»“æž„ã€‚

![](imgs/7.png)

#### 2.1.1 LSTMä¹‹é—å¿˜é—¨

ã€€ã€€ã€€ã€€é—å¿˜é—¨ï¼ˆforget gateï¼‰é¡¾åæ€ä¹‰ï¼Œæ˜¯æŽ§åˆ¶æ˜¯å¦é—å¿˜çš„ï¼Œåœ¨LSTMä¸­å³ä»¥ä¸€å®šçš„æ¦‚çŽ‡æŽ§åˆ¶æ˜¯å¦é—å¿˜ä¸Šä¸€å±‚çš„éšè—ç»†èƒžçŠ¶æ€ã€‚é—å¿˜é—¨å­ç»“æž„å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š

![](imgs/9.png)



![[å…¬å¼]](https://www.zhihu.com/equation?tex=C_t+%3D+f_t+%5Ctimes+C_%7Bt-1%7D+%2B+i_t+%5Ctimes+%5Ctilde%7BC%7D_t+%5Ctag%7B3%7D)

å…¶ä¸­ ![[å…¬å¼]](https://www.zhihu.com/equation?tex=f_t) å«åšé—å¿˜é—¨ï¼Œè¡¨ç¤º ![[å…¬å¼]](https://www.zhihu.com/equation?tex=C_%7Bt-1%7D) çš„å“ªäº›ç‰¹å¾è¢«ç”¨äºŽè®¡ç®— ![[å…¬å¼]](https://www.zhihu.com/equation?tex=C_t) ã€‚ ![[å…¬å¼]](https://www.zhihu.com/equation?tex=f_t) æ˜¯ä¸€ä¸ªå‘é‡ï¼Œå‘é‡çš„æ¯ä¸ªå…ƒç´ å‡ä½äºŽ ![[å…¬å¼]](https://www.zhihu.com/equation?tex=%5B0%2C1%5D) èŒƒå›´å†…ã€‚é€šå¸¸æˆ‘ä»¬ä½¿ç”¨ ![[å…¬å¼]](https://www.zhihu.com/equation?tex=sigmoid) ä½œä¸ºæ¿€æ´»å‡½æ•°ï¼Œ ![[å…¬å¼]](https://www.zhihu.com/equation?tex=sigmoid) çš„è¾“å‡ºæ˜¯ä¸€ä¸ªä»‹äºŽ ![[å…¬å¼]](https://www.zhihu.com/equation?tex=%5B0%2C+1%5D) åŒºé—´å†…çš„å€¼ï¼Œä½†æ˜¯å½“ä½ è§‚å¯Ÿä¸€ä¸ªè®­ç»ƒå¥½çš„LSTMæ—¶ï¼Œä½ ä¼šå‘çŽ°é—¨çš„å€¼ç»å¤§å¤šæ•°éƒ½éžå¸¸æŽ¥è¿‘0æˆ–è€…1ï¼Œå…¶ä½™çš„å€¼å°‘ä¹‹åˆå°‘ã€‚å…¶ä¸­ ![[å…¬å¼]](https://www.zhihu.com/equation?tex=%5Cotimes) æ˜¯LSTMæœ€é‡è¦çš„é—¨æœºåˆ¶ï¼Œè¡¨ç¤º ![[å…¬å¼]](https://www.zhihu.com/equation?tex=f_t) å’Œ ![[å…¬å¼]](https://www.zhihu.com/equation?tex=C_%7Bt-1%7D) ä¹‹é—´çš„å•ä½ä¹˜çš„å…³ç³»ã€‚

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](imgs/sfvn.png)



#### 2.1.2 LSTMä¹‹è¾“å…¥é—¨

ã€€ã€€ã€€ã€€è¾“å…¥é—¨ï¼ˆinput gateï¼‰è´Ÿè´£å¤„ç†å½“å‰åºåˆ—ä½ç½®çš„è¾“å…¥ï¼Œå®ƒçš„å­ç»“æž„å¦‚ä¸‹å›¾ï¼š

![](imgs/10.png)



![[å…¬å¼]](https://www.zhihu.com/equation?tex=%5Ctilde%7BC%7D_t) *è¡¨ç¤ºå•å…ƒçŠ¶æ€æ›´æ–°å€¼ï¼Œç”±è¾“å…¥æ•°æ®* ![[å…¬å¼]](https://www.zhihu.com/equation?tex=x_t) *å’ŒéšèŠ‚ç‚¹* ![[å…¬å¼]](https://www.zhihu.com/equation?tex=h_%7Bt-1%7D) ç»ç”±ä¸€ä¸ªç¥žç»ç½‘ç»œå±‚å¾—åˆ°ï¼Œå•å…ƒçŠ¶æ€æ›´æ–°å€¼çš„æ¿€æ´»å‡½æ•°é€šå¸¸ä½¿ç”¨ ![[å…¬å¼]](https://www.zhihu.com/equation?tex=tanh) ã€‚ ![[å…¬å¼]](https://www.zhihu.com/equation?tex=i_t) å«åšè¾“å…¥é—¨ï¼ŒåŒ ![[å…¬å¼]](https://www.zhihu.com/equation?tex=f_t) ä¸€æ ·ä¹Ÿæ˜¯ä¸€ä¸ªå…ƒç´ ä»‹äºŽ ![[å…¬å¼]](https://www.zhihu.com/equation?tex=%5B0%2C+1%5D) åŒºé—´å†…çš„å‘é‡ï¼ŒåŒæ ·ç”± ![[å…¬å¼]](https://www.zhihu.com/equation?tex=x_t) å’Œ ![[å…¬å¼]](https://www.zhihu.com/equation?tex=h_%7Bt-1%7D) ç»ç”± ![[å…¬å¼]](https://www.zhihu.com/equation?tex=sigmoid) æ¿€æ´»å‡½æ•°è®¡ç®—è€Œæˆã€‚


![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](imgs/fvvsadf.png)

#### 2.1.3 LSTMä¹‹ç»†èƒžçŠ¶æ€æ›´æ–°

![](imgs/11.png)



![[å…¬å¼]](https://www.zhihu.com/equation?tex=i_t) ç”¨äºŽæŽ§åˆ¶ ![[å…¬å¼]](https://www.zhihu.com/equation?tex=%5Ctilde%7BC%7D_t) çš„å“ªäº›ç‰¹å¾ç”¨äºŽæ›´æ–° ![[å…¬å¼]](https://www.zhihu.com/equation?tex=C_t)

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](imgs/bfdbfds.png)

#### 2.1.4 LSTMä¹‹è¾“å‡ºé—¨

![](imgs/12.png)



![[å…¬å¼]](https://www.zhihu.com/equation?tex=h_t) ç”±è¾“å‡ºé—¨ ![[å…¬å¼]](https://www.zhihu.com/equation?tex=o_t) å’Œå•å…ƒçŠ¶æ€ ![[å…¬å¼]](https://www.zhihu.com/equation?tex=C_t) å¾—åˆ°ï¼Œå…¶ä¸­ ![[å…¬å¼]](https://www.zhihu.com/equation?tex=o_t) çš„è®¡ç®—æ–¹å¼å’Œ ![[å…¬å¼]](https://www.zhihu.com/equation?tex=f_t) ä»¥åŠ ![[å…¬å¼]](https://www.zhihu.com/equation?tex=i_t) ç›¸åŒã€‚åœ¨[3]çš„è®ºæ–‡ä¸­æŒ‡å‡ºï¼Œé€šè¿‡å°† ![[å…¬å¼]](https://www.zhihu.com/equation?tex=b_o) çš„å‡å€¼åˆå§‹åŒ–ä¸º ![[å…¬å¼]](https://www.zhihu.com/equation?tex=1) ï¼Œå¯ä»¥ä½¿LSTMè¾¾åˆ°åŒGRUè¿‘ä¼¼çš„æ•ˆæžœã€‚

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](imgs/fbgfhsds.png)

### 2.2 LSTMå‰å‘ä¼ æ’­ç®—æ³•

![](imgs/13.png)

### 2.3  LSTMåå‘ä¼ æ’­ç®—æ³•æŽ¨å¯¼å…³é”®ç‚¹

ã€€ã€€ã€€ã€€æœ‰äº†LSTMå‰å‘ä¼ æ’­ç®—æ³•ï¼ŒæŽ¨å¯¼åå‘ä¼ æ’­ç®—æ³•å°±å¾ˆå®¹æ˜“äº†ï¼Œ æ€è·¯å’ŒRNNçš„åå‘ä¼ æ’­ç®—æ³•æ€è·¯ä¸€è‡´ï¼Œä¹Ÿæ˜¯é€šè¿‡æ¢¯åº¦ä¸‹é™æ³•è¿­ä»£æ›´æ–°æˆ‘ä»¬æ‰€æœ‰çš„å‚æ•°ï¼Œå…³é”®ç‚¹åœ¨äºŽè®¡ç®—æ‰€æœ‰å‚æ•°åŸºäºŽæŸå¤±å‡½æ•°çš„åå¯¼æ•°ã€‚

![](imgs/14.png)

![](imgs/15.png)

### 2.4 LSTMå°ç»“

ã€€ã€€ã€€ã€€LSTMè™½ç„¶ç»“æž„å¤æ‚ï¼Œä½†æ˜¯åªè¦ç†é¡ºäº†é‡Œé¢çš„å„ä¸ªéƒ¨åˆ†å’Œä¹‹é—´çš„å…³ç³»ï¼Œè¿›è€Œç†è§£å‰å‘åå‘ä¼ æ’­ç®—æ³•æ˜¯ä¸éš¾çš„ã€‚å½“ç„¶å®žé™…åº”ç”¨ä¸­LSTMçš„éš¾ç‚¹ä¸åœ¨å‰å‘åå‘ä¼ æ’­ç®—æ³•ï¼Œè¿™äº›æœ‰ç®—æ³•åº“å¸®ä½ æžå®šï¼Œæ¨¡åž‹ç»“æž„å’Œä¸€å¤§å †å‚æ•°çš„è°ƒå‚æ‰æ˜¯è®©äººå¤´ç—›çš„é—®é¢˜ã€‚ä¸è¿‡ï¼Œç†è§£LSTMæ¨¡åž‹ç»“æž„ä»ç„¶æ˜¯é«˜æ•ˆä½¿ç”¨çš„å‰æã€‚

## 3. GRU

 çŸ¥é“äº† LSTM çš„å·¥ä½œåŽŸç†ä¹‹åŽï¼Œæ¥äº†è§£ä¸€ä¸‹ GRUã€‚GRU æ˜¯æ–°ä¸€ä»£çš„å¾ªçŽ¯ç¥žç»ç½‘ç»œï¼Œä¸Ž LSTM éžå¸¸ç›¸ä¼¼ã€‚ä¸Ž LSTM ç›¸æ¯”ï¼ŒGRU åŽ»é™¤æŽ‰äº†ç»†èƒžçŠ¶æ€ï¼Œä½¿ç”¨éšè—çŠ¶æ€æ¥è¿›è¡Œä¿¡æ¯çš„ä¼ é€’ã€‚å®ƒåªåŒ…å«ä¸¤ä¸ªé—¨ï¼šæ›´æ–°é—¨å’Œé‡ç½®é—¨ã€‚

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](imgs/asdfsad.png)

### 3.1 GRUç½‘ç»œç»“æž„

**é‡ç½®é—¨**ï¼šç”¨äºŽå†³å®šé—å¿˜å…ˆå‰ä¿¡æ¯çš„ç¨‹åº¦ã€‚

**æ›´æ–°é—¨**ï¼šç±»ä¼¼äºŽLSTMä¸­çš„é—å¿˜é—¨å’Œè¾“å…¥é—¨ï¼Œå†³å®šäº†è¦å¿˜è®°é‚£äº›ä¿¡æ¯ä»¥åŠé‚£äº›ä¿¡æ¯éœ€è¦è¢«æ·»åŠ ã€‚

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](imgs/bdfshsd.png)

ç›¸æ¯”äºŽRNNï¼Œæˆ‘ä»¬åªæ˜¯ä¸­é—´éšè—å±‚çš„ç»“æž„å‘ç”Ÿäº†å˜åŒ–ã€‚

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](imgs/fdsg.png)



Ïƒä¸ºsigmoidå‡½æ•°ï¼Œé€šè¿‡è¿™ä¸ªå‡½æ•°å¯ä»¥å°†æ•°æ®å˜æ¢ä¸º0-1èŒƒå›´å†…çš„æ•°å€¼ï¼Œä»Žè€Œæ¥å……å½“é—¨æŽ§ä¿¡å·

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](imgs/bdsfg.png)

å¾—åˆ°é—¨æŽ§ä¿¡å·ä¹‹åŽï¼Œé¦–å…ˆä½¿ç”¨é‡ç½®é—¨æ¥æŽ§åˆ¶â€œé‡ç½®â€ä¹‹åŽçš„æ•°æ®$h^{t-1'}=h^{t-1}\odot r$, å†å°†$h^{t-1'}$ ä¸Žè¾“å…¥$x^t$ è¿›è¡Œæ‹¼æŽ¥ï¼Œå†é€šè¿‡ä¸€ä¸ªtanhæ¿€æ´»å‡½æ•°æ¥å°†æ•°æ®ç¼©æ”¾åˆ°-1ï½ž1çš„èŒƒå›´å†…ï¼Œ å¾—åˆ°h'ã€‚

![image-20210721213108767](imgs/image-20210721213108767.png)

è¿™é‡Œçš„h'ä¸»è¦æ˜¯åŒ…å«äº†å½“å‰è¾“å…¥çš„$x^t$ æ•°æ®ã€‚æœ‰é’ˆå¯¹æ€§åœ°å¯¹h'æ·»åŠ åˆ°å½“å‰çš„éšè—çŠ¶æ€ï¼Œç›¸å½“äºŽâ€œè®°å¿†äº†å½“å‰æ—¶åˆ»çš„çŠ¶æ€â€ã€‚ç±»ä¼¼äºŽLSTMçš„é€‰æ‹©è®°å¿†é˜¶æ®µã€‚

æœ€åŽä»‹ç»GRUæœ€å…³é”®çš„ä¸€ä¸ªæ­¥éª¤ï¼Œæˆ‘ä»¬å¯ä»¥ç§°ä¹‹ä¸ºâ€œæ›´æ–°è®°å¿†â€é˜¶æ®µã€‚åœ¨è¿™ä¸ªé˜¶æ®µï¼Œæˆ‘ä»¬åŒæ—¶è¿›è¡Œäº†é—å¿˜è®°å¿†ä¸¤ä¸ªæ­¥éª¤ã€‚æˆ‘ä»¬ä½¿ç”¨äº†å…ˆå‰å¾—åˆ°çš„æ›´æ–°é—¨æŽ§z(update gate)ã€‚

æ›´æ–°è¡¨è¾¾å¼ï¼š$h^t = (1 - z) \odot h^{t-1} + z \odot h'$

GRUå¾ˆèªæ˜Žçš„ä¸€ç‚¹å°±åœ¨äºŽï¼Œ **ä½¿ç”¨äº†åŒä¸€ä¸ªé—¨æŽ§z å°±åŒæ—¶å¯ä»¥è¿›è¡Œé—å¿˜å’Œé€‰æ‹©è®°å¿†ï¼ˆLSTMåˆ™è¦ä½¿ç”¨å¤šä¸ªé—¨æŽ§ï¼‰ã€‚**



![image-20210721214007678](imgs/image-20210721214007678.png)



![image-20210721214046826](imgs/image-20210721214046826.png)

### **3.2 æ€»ç»“**

GRUè¾“å…¥è¾“å‡ºçš„ç»“æž„ä¸Žæ™®é€šçš„RNNç›¸ä¼¼ï¼Œå…¶ä¸­çš„å†…éƒ¨æ€æƒ³ä¸ŽLSTMç›¸ä¼¼ã€‚

ä¸ŽLSTMç›¸æ¯”ï¼ŒGRUå†…éƒ¨å°‘äº†ä¸€ä¸ªâ€é—¨æŽ§â€œï¼Œå‚æ•°æ¯”LSTMå°‘ï¼Œä½†æ˜¯å´ä¹Ÿèƒ½å¤Ÿè¾¾åˆ°ä¸ŽLSTMç›¸å½“çš„åŠŸèƒ½ã€‚è€ƒè™‘åˆ°ç¡¬ä»¶çš„è®¡ç®—èƒ½åŠ›å’Œæ—¶é—´æˆæœ¬ï¼Œå› è€Œå¾ˆå¤šæ—¶å€™æˆ‘ä»¬ä¹Ÿå°±ä¼šé€‰æ‹©æ›´åŠ â€å®žç”¨â€œçš„GRUå•¦ã€‚



## 4. CNNã€RNNã€LSTMã€GRU

- CNN:è¾“å…¥æ˜¯é™æ€çš„ï¼Œä¸éšç€æ—¶é—´è€Œæ”¹å˜ã€‚ç”¨çš„æ–¹æ³•æ˜¯å·ç§¯ã€‚æ¨¡åž‹ç»“æž„ç‰¹ç‚¹æ˜¯ï¼šè¾“å…¥å±‚---è‹¥å¹²ä¸ªï¼ˆå·ç§¯å±‚-æ¿€æ´»å‡½æ•°---æ± åŒ–å±‚ï¼‰---å…¨è¿žæŽ¥å±‚-æ¿€æ´»å‡½æ•°
- RNNï¼šè¾“å…¥æ˜¯æ—¶é—´è¿žç»­çš„ï¼Œæ–¹æ³•æ˜¯çŸ©é˜µç›¸ä¹˜ã€‚ç»“æž„ç‰¹ç‚¹æ˜¯ä¸æ–­å¾ªçŽ¯ä¼ é€’ä¸Šä¸€æ—¶åˆ»çš„éšè—å±‚çŠ¶æ€ã€‚æ¨¡åž‹ç»“æž„ï¼šè¾“å…¥å±‚---éšè—å±‚---è¾“å‡ºå±‚ã€‚ç”¨æŸå¤±å‡½æ•°Lä¸æ–­è¿­ä»£æ›´æ–°å‚æ•°ã€‚æ—¶é—´è·ç¦»è¶Šè¿œçš„ä¿¡æ¯ï¼Œå¯¹å½“å‰æ—¶åˆ»çš„è´¡çŒ®è¶Šå°ã€‚
- LSTMï¼šåœ¨RNNç»“æž„ä¸Šåšäº†æ”¹è¿›ï¼Œèƒ½å¤Ÿé€‰æ‹©æ˜¯å¦é—å¿˜æŽ‰ä¸Šä¸€ä¸ªæ—¶åˆ»çš„éšè—å±‚çŠ¶æ€ã€‚èƒ½å¤Ÿé¿å…æ¢¯åº¦æ¶ˆå¤±ï¼Œèƒ½å¤Ÿæ›´å¥½åœ°åˆ©ç”¨ä¹‹å‰çš„ä¿¡æ¯ã€‚
- GRUé™¤åœ¨è¯­è¨€æ¨¡åž‹çš„åœºæ™¯ä¸­è¡¨çŽ°å‡è¶…è¿‡LSTM
- LSTMçš„è¾“å‡ºé—¨çš„åç½®çš„å‡å€¼åˆå§‹åŒ–ä¸º1æ—¶ï¼ŒLSTMçš„æ€§èƒ½æŽ¥è¿‘GRUï¼›
- åœ¨LSTMä¸­ï¼Œé—¨çš„é‡è¦æ€§æŽ’åºæ˜¯é—å¿˜é—¨ > è¾“å…¥é—¨ > è¾“å‡ºé—¨

