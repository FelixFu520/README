# BPç®—æ³•è®²è§£

âŒšï¸: 2021å¹´4æœˆ1æ—¥

ğŸ“šå‚è€ƒ

- [ç¥ç»ç½‘ç»œä¹‹BPç®—æ³•(å›¾è¯´ç¥ç»ç½‘ç»œ+BPç®—æ³•ç†è®ºæ¨å¯¼+ä¾‹å­è¿ç”¨+ä»£ç )](https://blog.csdn.net/weixin_39441762/article/details/80446692)

---

## 1.    5å­—è¯€æå®šBPåå‘ä¼ æ’­ç®—æ³•æ¨å¯¼

> [å“”å“©å“”å“©è§†é¢‘](https://www.bilibili.com/video/BV13J41157Wq?p=4)
>
> é¸¡é¸¡è¸¢è¿é•¿

### 1.1 è®¡ç®—å›¾

![](imgs/è®¡ç®—å›¾.png)

### 1.2 æ¿€æ´»å‡½æ•°

![](imgs/æ¿€æ´»å‡½æ•°.png)

### 1.3 æ¢¯åº¦æ±‚å¯¼

![](imgs/æ¢¯åº¦ä¸‹é™.png)

### 1.4 é“¾å¼æ±‚å¯¼

ç•¥ï¼Œè§è§†é¢‘

### 1.5 å¼ é‡æ±‚å¯¼

![](imgs/å¼ é‡æ±‚å¯¼1.png)

â€œYXæ‹‰ä¼¸æœ¯â€æ˜¯Yå‚ç›´æ‹‰å¼€ï¼ŒXæ°´å¹³æ‹‰å¼€ã€‚



![](imgs/å¼ é‡æ±‚å¯¼2.png)

![](imgs/å¼ é‡æ±‚å¯¼3.png)

![](imgs/å¼ é‡æ±‚å¯¼4.png)

"æ±‚å¯¼å‡é˜¶"ï¼Œ1é˜¶å¼ é‡å¯¹2é˜¶çŸ©é˜µæ±‚å¯¼ï¼Œç»“æœæ˜¯3é˜¶å¼ é‡ã€‚

### 1.6 BPæ¨å¯¼

![](imgs/bp1.png)

![](imgs/bp2.jpeg)

![](imgs/bp3.png)



## 2. ç¥ç»ç½‘ç»œä¹‹BPç®—æ³•

åŸæ–‡åœ°å€è§æœ«å°¾ã€‚   

åŸæ–‡å†™äº2018å¹´5æœˆã€‚ä¿®æ”¹äº2019å¹´11æœˆ17ã€‚ 

æœ€è¿‘åœ¨å­¦ä¹ ã€ŠDeep Learningã€‹è¿™æœ¬ä¹¦ï¼Œä¹¦ä¸­åœ¨å‰é¦ˆç¥ç»ç½‘ç»œã€å…¨è¿æ¥ç¥ç»ç½‘ç»œä»¥åŠå·ç§¯ç¥ç»ç½‘ç»œç­‰å†…å®¹ä¸­ï¼Œéƒ½æœ‰æåˆ°åå‘ä¼ æ’­ç®—æ³•ï¼Œè¿™ä¸€ç®—æ³•å¯ä»¥è¯´æ˜¯ç¥ç»ç½‘ç»œä¸­**æ±‚è§£å‚æ•°**æ¯”è¾ƒæ ¸å¿ƒçš„éƒ¨åˆ†äº†ã€‚ä¸ºäº†æ›´å¥½åœ°ç†è§£ç¥ç»ç½‘ç»œå·¥ä½œçš„åŸç†ï¼Œè®¤è¯†åå‘ä¼ æ’­åœ¨ç¥ç»ç½‘ç»œä¸­çš„è¿ç®—æœºåˆ¶ï¼Œåœ¨ç»¼åˆã€ŠDeep Learningã€‹ä¹¦ä¸­çš„æœ‰å…³éƒ¨åˆ†å¹¶ä¸”å­¦ä¹ äº†bç«™è®²è§£ç¥ç»ç½‘ç»œçš„ç›¸å…³è§†é¢‘åŠä¸€äº›æœ‰å…³äºBPç®—æ³•çš„åšå®¢æ–‡ç« ä¹‹åï¼Œç¬”è€…å°†è‡ªå·±çš„ç†è§£å†™ä¸‹æ¥ï¼Œå¸Œæœ›èƒ½ä¸ºåˆå­¦è€…ç†è§£åå‘ä¼ æ’­ç®—æ³•èµ·åˆ°ä¸€å®šçš„å¸®åŠ©ã€‚åœ¨æ­¤ï¼Œå¯¹å·²ä¸ºBPç®—æ³•æä¾›äº†å­¦ä¹ æ€è·¯çš„å„ä½å‰è¾ˆè¡¨ç¤ºæ•¬æ„ï¼Œç‰¹åˆ«æ˜¯å¸®åŠ©æˆ‘æ€è€ƒå’Œç†è§£BPç®—æ³•çš„ä¸‰ä½åšä¸»ã€‚

å…³äºåå‘ä¼ æ’­ç®—æ³•ï¼Œæˆ‘ä»¬é¦–å…ˆéœ€è¦æ¸…æ¥šå®ƒçš„åº”ç”¨é€”å¾„ï¼›å…¶æ¬¡,åšä¸€äº›ç¥ç»ç½‘ç»œçŸ¥è¯†çš„å‰æœŸå‚¨å¤‡ï¼›ä¹‹åï¼Œå­¦ä¹ BPç®—æ³•çš„å·¥ä½œåŸç†ï¼›æœ€åï¼Œè®¤è¯†åˆ°BPç®—æ³•çš„å±€é™æ€§,äº†è§£æ”¹è¿›æ–¹æ³•ã€‚å› æ­¤ï¼Œæœ¬æ–‡ä»è¿™4ä¸ªç‚¹æ¥è®²è§£ï¼Œåˆ’åˆ†ä¸º6éƒ¨åˆ†ï¼š

### **2.1  åå‘ä¼ æ’­ç®—æ³•åº”ç”¨é¢†åŸŸ**

 åå‘ä¼ æ’­ç®—æ³•åº”ç”¨è¾ƒä¸ºå¹¿æ³›ï¼Œä»å­—é¢æ„æ€ç†è§£ï¼Œä¸å‰å‘ä¼ æ’­ç›¸äº’å¯¹åº”ã€‚åœ¨ç®€å•çš„ç¥ç»ç½‘ç»œä¸­ï¼Œåå‘ä¼ æ’­ç®—æ³•ï¼Œå¯ä»¥ç†è§£ä¸ºæœ€ä¼˜åŒ–æŸå¤±å‡½æ•°è¿‡ç¨‹ï¼Œæ±‚è§£æ¯ä¸ªå‚ä¸è¿ç®—çš„å‚æ•°çš„æ¢¯åº¦çš„æ–¹æ³•ã€‚åœ¨å‰é¦ˆç¥ç»ç½‘ç»œä¸­ï¼Œåå‘ä¼ æ’­ä»æ±‚è§£æŸå¤±å‡½æ•°åå¯¼è¿‡ç¨‹ä¸­ï¼Œæ­¥æ­¥å‘å‰æ±‚è§£æ¯ä¸€å±‚çš„å‚æ•°æ¢¯åº¦ã€‚åœ¨å·ç§¯ç¥ç»ç½‘ç»œä¸­ï¼Œåå‘ä¼ æ’­å¯ä»¥æ±‚è§£å…¨è¿æ¥å±‚çš„å‚æ•°æ¢¯åº¦ã€‚åœ¨å¾ªç¯ç¥ç»ç½‘ç»œä¸­ï¼Œåå‘ä¼ æ’­ç®—æ³•å¯ä»¥æ±‚è§£æ¯ä¸€ä¸ªæ—¶åˆ»tæˆ–è€…çŠ¶æ€tçš„å‚æ•°æ¢¯åº¦ï¼ˆåœ¨RNN\LSTM\GRUä¸­ï¼Œåå‘ä¼ æ’­æ›´å¤šæ˜¯BPTTï¼‰ã€‚ç¬”è€…å¦‚ä»Šå¯¹äºBPçš„ç†è§£ï¼Œè®¤ä¸ºæ˜¯åœ¨ä¼˜åŒ–æŸå¤±å‡½æ•°æˆ–è€…ç›®æ ‡å‡½æ•°è¿‡ç¨‹ä¸­ï¼Œæ±‚è§£å‚ä¸è¿ç®—çš„å‚æ•°çš„æ¢¯åº¦æ–¹æ³•ï¼Œæ˜¯ä¸€ç§æ¯”è¾ƒæ™®éçš„è¯´æ³•ã€‚

### **2.2 å‡†å¤‡çŸ¥è¯†--**åå‘ä¼ æ’­(BP)ç®—æ³•åº”ç”¨äºç¥ç»ç½‘ç»œ

åå‘ä¼ æ’­(BP)ç®—æ³•åœ¨æ·±åº¦å­¦ä¹ ä¸­ï¼Œåº”ç”¨å¹¿æ³›ã€‚è¿™é‡Œä»…ä»¥å‰é¦ˆç¥ç»ç½‘ç»œä¸­çš„BPç®—æ³•ä½œä¸ºä»‹ç»ã€‚ç¥ç»ç½‘ç»œæ˜¯ä¸€ä¸ªç”±è¾“å…¥å±‚ã€éšè—å±‚ã€è¾“å‡ºå±‚ä¸‰éƒ¨åˆ†ç»„æˆçš„ç½‘ç»œï¼šæ•°æ®ä»è¾“å…¥å±‚ï¼Œç»è¿‡æƒé‡å€¼å’Œåç½®é¡¹çš„çº¿æ€§å˜æ¢å¤„ç†ï¼Œå†é€šè¿‡æ¿€æ´»å±‚ï¼Œå¾—åˆ°éšè—å±‚çš„è¾“å‡ºï¼Œä¹Ÿå³ä¸‹ä¸€å±‚çš„è¾“å…¥ï¼›éšè—å±‚åˆ°è¾“å‡ºå±‚ä¹‹é—´æ˜¯ï¼Œç»è¿‡æƒé‡å€¼å’Œåç½®é¡¹çš„çº¿æ€§å˜æ¢ï¼Œä¹‹åé€šè¿‡æ¿€æ´»å±‚ï¼Œå¾—åˆ°è¾“å‡ºå±‚ã€‚

â€‹    

![img](imgs/59.png)

å›¾2è¡¨ç¤ºä¸€ä¸ªç½‘ç»œå±‚ä¸º2çš„å‰é¦ˆç¥ç»ç½‘ç»œï¼šä¸€ä¸ªéšè—å±‚ï¼Œä¸€ä¸ªè¾“å‡ºå±‚ï¼›éšè—å•å…ƒä¸º5ï¼Œè®°è¾“å…¥å±‚åˆ°éšè—å±‚çš„æƒé‡å€¼ä¸ºWï¼Œåç½®é¡¹ä¸ºb1,æ¿€æ´»å‡½æ•°ä¸ºg1ï¼Œéšè—å±‚åˆ°è¾“å‡ºå±‚çš„æƒé‡å€¼ä¸ºV,åç½®é¡¹ä¸ºb2ï¼Œæ¿€æ´»å‡½æ•°ä¸ºg2ï¼Œåˆ™å›¾2çš„æ¨¡å‹å³ä¸ºï¼š

  ![\hat{Y}=g_{2}(V^{T}g_{1}(W^{T}X+b_{1})+b_{2})](https://private.codecogs.com/gif.latex?%5Chat%7BY%7D%3Dg_%7B2%7D%28V%5E%7BT%7Dg_%7B1%7D%28W%5E%7BT%7DX&plus;b_%7B1%7D%29&plus;b_%7B2%7D%29)

å›¾2æ˜¯ä¸€ä¸ªæ¯”è¾ƒç®€å•çš„ç¥ç»ç½‘ç»œï¼Œé€šå¸¸ï¼Œæˆ‘ä»¬è§åˆ°çš„ç¥ç»ç½‘ç»œï¼Œæ˜¯å…·æœ‰å¤šä¸ªéšè—å±‚çš„ç½‘ç»œï¼Œå¦‚å›¾3ï¼šè¿™æ˜¯ä¸€ä¸ªéšè—å±‚ä¸ªæ•°ä¸ºNä¸ªï¼Œæ¯å±‚éšè—å•å…ƒæ•°ä¸º5çš„ç¥ç»ç½‘ç»œã€‚ï¼ˆPSï¼šéšè—å±‚è®¾è®¡ï¼Œå¯ä»¥è€ƒè™‘å±‚æ•°è®¾è®¡å’Œéšè—å•å…ƒè®¾è®¡ï¼Œå¯æ ¹æ®è‡ªå·±çš„éœ€è¦è‡ªè¡Œè®¾è®¡ã€‚)

   

![img](imgs/61.png)

ä»è¾“å…¥å±‚åˆ°éšè—å±‚å†åˆ°è¾“å‡ºå±‚ï¼Œè¿™ä¸€å‘å‰ä¼ é€’çš„è¿‡ç¨‹ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸ºå‰å‘ä¼ æ’­ã€‚å‰å‘ä¼ æ’­è¿‡ç¨‹ï¼Œå¾€å¾€æ˜¯æˆ‘ä»¬è®¾å®šæ¨¡å‹çš„è¿‡ç¨‹ï¼Œä¹Ÿå¯ä»¥ç†è§£ä¸ºè®¾å®šæ•°å­¦è¡¨è¾¾å¼æˆ–è€…åˆ—æ–¹ç¨‹çš„è¿‡ç¨‹ã€‚



### **2.3 BPç®—æ³•åŸç†åŠå…¶å®æ–½æ­¥éª¤**

BPç®—æ³•çš„æ ¸å¿ƒæ€æƒ³ï¼šä½¿ç”¨æ¢¯åº¦ä¸‹é™æ¥æœç´¢å¯èƒ½çš„æƒå‘é‡çš„å‡è®¾ç©ºé—´ï¼Œä»¥æ‰¾åˆ°æœ€ä½³çš„æ‹Ÿåˆæ ·ä¾‹çš„æƒå‘é‡ã€‚å…·ä½“è€Œè¨€ï¼Œå³åˆ©ç”¨æŸå¤±å‡½æ•°ï¼Œæ¯æ¬¡å‘æŸå¤±å‡½æ•°è´Ÿæ¢¯åº¦æ–¹å‘ç§»åŠ¨ï¼Œç›´åˆ°æŸå¤±å‡½æ•°å–å¾—æœ€å°å€¼ã€‚

æˆ–è€…è¯´ï¼Œåå‘ä¼ æ’­ç®—æ³•ï¼Œæ˜¯æ ¹æ®æŸå¤±å‡½æ•°ï¼Œæ±‚å‡ºæŸå¤±å‡½æ•°å…³äºæ¯ä¸€å±‚çš„æƒå€¼åŠåç½®é¡¹çš„åå¯¼æ•°ï¼Œä¹Ÿç§°ä¸ºæ¢¯åº¦ï¼Œç”¨è¯¥å€¼æ›´æ–°åˆå§‹çš„æƒå€¼å’Œåç½®é¡¹ï¼Œä¸€ç›´æ›´æ–°åˆ°æŸå¤±å‡½æ•°å–å¾—æœ€å°å€¼æˆ–æ˜¯è®¾ç½®çš„è¿­ä»£æ¬¡æ•°å®Œæˆä¸ºæ­¢ã€‚ä»¥æ­¤æ¥è®¡ç®—ç¥ç»ç½‘ç»œä¸­çš„æœ€ä½³çš„å‚æ•°ã€‚

ç”±æ­¤ï¼Œæ­£å¼ä»‹ç»BPç®—æ³•å‰ï¼Œæˆ‘ä»¬éœ€è¦çŸ¥é“å‰å‘ä¼ æ’­è¿‡ç¨‹ï¼Œç¡®å®šç½‘ç»œçš„è®¾è®¡ã€‚ä¸ºæ­¤å…ˆè®¾å®šä¸€ä¸ªåªæœ‰ä¸€å±‚çš„ç¥ç»ç½‘ç»œï¼Œä½œä¸ºè®²è§£ï¼Œå¦‚å›¾4.

â€‹                                      

![img](imgs/62.png)

è®¾å®šï¼šä»è¾“å…¥å±‚æ•°æ®ä¸ºXï¼Œè¾“å…¥å±‚åˆ°éšè—å±‚å‚æ•°ä¸ºw,b1ï¼Œéšè—å±‚åˆ°è¾“å‡ºå±‚å‚æ•°ä¸ºv,b2ï¼Œæ¿€æ´»å‡½æ•°ç”¨ä¸ºg1,g2ã€‚äºæ˜¯æ¨¡å‹è®¾å®šä¸ºï¼š

â€‹                                 ![net_{1} = w^{T}x+b_{1},h=g_{1}(net_{1})](https://private.codecogs.com/gif.latex?net_%7B1%7D%20%3D%20w%5E%7BT%7Dx&plus;b_%7B1%7D%2Ch%3Dg_%7B1%7D%28net_%7B1%7D%29)                      ï¼ˆ3-1ï¼‰

éšè—å±‚åˆ°è¾“å‡ºå±‚ï¼š

â€‹                                ![net_{2} = v^{T}h+b_{2},\hat{y}=g_{2}(net_{2})](https://private.codecogs.com/gif.latex?net_%7B2%7D%20%3D%20v%5E%7BT%7Dh&plus;b_%7B2%7D%2C%5Chat%7By%7D%3Dg_%7B2%7D%28net_%7B2%7D%29)                        ï¼ˆ3-2ï¼‰

æ¨¡å‹ï¼š

â€‹                  ![\hat{y}=g_{2}(net_{2})=g_{2}(v^{T}g_{1}(net_{1})+b_{2})=g_{2}(v^{T}g_{1}(w^{T}x+b_{1})+b_{2})](https://private.codecogs.com/gif.latex?%5Chat%7By%7D%3Dg_%7B2%7D%28net_%7B2%7D%29%3Dg_%7B2%7D%28v%5E%7BT%7Dg_%7B1%7D%28net_%7B1%7D%29&plus;b_%7B2%7D%29%3Dg_%7B2%7D%28v%5E%7BT%7Dg_%7B1%7D%28w%5E%7BT%7Dx&plus;b_%7B1%7D%29&plus;b_%7B2%7D%29)         ï¼ˆ3-3ï¼‰

æŸå¤±å‡½æ•°ï¼š

â€‹                                    ![E(\theta )=\frac{1}{2}\sum_{i=1}^{2} (y_{i}-\hat{y_{i}})^2](https://private.codecogs.com/gif.latex?E%28%5Ctheta%20%29%3D%5Cfrac%7B1%7D%7B2%7D%5Csum_%7Bi%3D1%7D%5E%7B2%7D%20%28y_%7Bi%7D-%5Chat%7By_%7Bi%7D%7D%29%5E2)                          ï¼ˆ3-4ï¼‰

å…¶ä¸­ï¼š

â€‹               ![x =\begin{pmatrix} x_{1}\\ x_{2}\\ x_{3}\\ x_{4} \end{pmatrix},w=\begin{pmatrix} w_{11} &w_{12} &... &w_{15} \\ w_{21}&w_{22} &... &w_{25} \\ w_{31}&w_{32} &... &w_{35} \\ w_{41} &w_{42} &... &w_{45} \end{pmatrix},b_{1}=\begin{pmatrix} b_{11}\\ b_{12}\\ ...\\ b_{14} \end{pmatrix},net_{1}=\begin{pmatrix} net_{11}\\ net_{12}\\ ...\\ net_{14} \end{pmatrix}](https://private.codecogs.com/gif.latex?x%20%3D%5Cbegin%7Bpmatrix%7D%20x_%7B1%7D%5C%5C%20x_%7B2%7D%5C%5C%20x_%7B3%7D%5C%5C%20x_%7B4%7D%20%5Cend%7Bpmatrix%7D%2Cw%3D%5Cbegin%7Bpmatrix%7D%20w_%7B11%7D%20%26w_%7B12%7D%20%26...%20%26w_%7B15%7D%20%5C%5C%20w_%7B21%7D%26w_%7B22%7D%20%26...%20%26w_%7B25%7D%20%5C%5C%20w_%7B31%7D%26w_%7B32%7D%20%26...%20%26w_%7B35%7D%20%5C%5C%20w_%7B41%7D%20%26w_%7B42%7D%20%26...%20%26w_%7B45%7D%20%5Cend%7Bpmatrix%7D%2Cb_%7B1%7D%3D%5Cbegin%7Bpmatrix%7D%20b_%7B11%7D%5C%5C%20b_%7B12%7D%5C%5C%20...%5C%5C%20b_%7B14%7D%20%5Cend%7Bpmatrix%7D%2Cnet_%7B1%7D%3D%5Cbegin%7Bpmatrix%7D%20net_%7B11%7D%5C%5C%20net_%7B12%7D%5C%5C%20...%5C%5C%20net_%7B14%7D%20%5Cend%7Bpmatrix%7D)

â€‹                   ![h =\begin{pmatrix} h_{1}\\ h_{2}\\ ...\\ h_{5} \end{pmatrix},v=\begin{pmatrix} v_{11} &v_{12} \\ v_{21} &v_{22} \\ ... &... \\ v_{51} &v_{52} \end{pmatrix},b_{2}=\begin{pmatrix} b_{21}\\ b_{22} \end{pmatrix},net_{2}=\begin{pmatrix} net_{21}\\ net_{22} \end{pmatrix}](https://private.codecogs.com/gif.latex?h%20%3D%5Cbegin%7Bpmatrix%7D%20h_%7B1%7D%5C%5C%20h_%7B2%7D%5C%5C%20...%5C%5C%20h_%7B5%7D%20%5Cend%7Bpmatrix%7D%2Cv%3D%5Cbegin%7Bpmatrix%7D%20v_%7B11%7D%20%26v_%7B12%7D%20%5C%5C%20v_%7B21%7D%20%26v_%7B22%7D%20%5C%5C%20...%20%26...%20%5C%5C%20v_%7B51%7D%20%26v_%7B52%7D%20%5Cend%7Bpmatrix%7D%2Cb_%7B2%7D%3D%5Cbegin%7Bpmatrix%7D%20b_%7B21%7D%5C%5C%20b_%7B22%7D%20%5Cend%7Bpmatrix%7D%2Cnet_%7B2%7D%3D%5Cbegin%7Bpmatrix%7D%20net_%7B21%7D%5C%5C%20net_%7B22%7D%20%5Cend%7Bpmatrix%7D)

â€‹                                   ![\hat{y}=\begin{pmatrix} \hat{y_{1}}\\ \hat{y_{2}} \end{pmatrix},y=\begin{pmatrix} y_{1}\\ y_{2}\end{pmatrix}](https://private.codecogs.com/gif.latex?%5Chat%7By%7D%3D%5Cbegin%7Bpmatrix%7D%20%5Chat%7By_%7B1%7D%7D%5C%5C%20%5Chat%7By_%7B2%7D%7D%20%5Cend%7Bpmatrix%7D%2Cy%3D%5Cbegin%7Bpmatrix%7D%20y_%7B1%7D%5C%5C%20y_%7B2%7D%5Cend%7Bpmatrix%7D)    

ä»¥ä¸Šè¿°çš„æ¨¡å‹è®¾å®šä¸ºä¾‹ï¼Œä¸‹é¢ä»‹ç»BPç®—æ³•æ­¥éª¤ï¼Œé€šè¿‡BPç®—æ³•çš„æ­¥éª¤ï¼Œäº†è§£åå‘ä¼ æ’­ï¼Œæ˜¯å¦‚ä½•å®ç°æ¨¡å‹çš„å‚æ•°æ›´æ–°ã€‚



#### 2.3.1 **å®æ–½æ­¥éª¤ï¼š**

  **1ï¼‰**åˆå§‹åŒ–ç½‘ç»œä¸­çš„æƒå€¼å’Œåç½®é¡¹ï¼Œåˆ†åˆ«è®°ä¸º

  **![w^{(0)},b_{1}^{(0)},v^{(0)},b_{2}^{(0)}](https://private.codecogs.com/gif.latex?w%5E%7B%280%29%7D%2Cb_%7B1%7D%5E%7B%280%29%7D%2Cv%5E%7B%280%29%7D%2Cb_%7B2%7D%5E%7B%280%29%7D)**                             ï¼ˆ3-5ï¼‰



  **2ï¼‰**æ¿€æ´»å‰å‘ä¼ æ’­ï¼Œå¾—åˆ°å„å±‚è¾“å‡ºå’ŒæŸå¤±å‡½æ•°çš„æœŸæœ›å€¼

**![E(\theta )=\frac{1}{2}\sum_{i=1}^{2}(y_{i}-\hat{y_{i}})^{2}](https://private.codecogs.com/gif.latex?E%28%5Ctheta%20%29%3D%5Cfrac%7B1%7D%7B2%7D%5Csum_%7Bi%3D1%7D%5E%7B2%7D%28y_%7Bi%7D-%5Chat%7By_%7Bi%7D%7D%29%5E%7B2%7D)**                          ï¼ˆ3-6ï¼‰

  å…¶ä¸­ï¼Œ**![\theta](https://private.codecogs.com/gif.latex?%5Ctheta)**è¡¨ç¤ºå‚æ•°é›†åˆï¼Œ![y](https://private.codecogs.com/gif.latex?y)è¡¨ç¤ºçœŸå®å€¼**ï¼Œ![\hat{y}](https://private.codecogs.com/gif.latex?%5Chat%7By%7D)**è¡¨ç¤ºé¢„æµ‹å€¼ï¼Œ![\frac{1}{2}](https://private.codecogs.com/gif.latex?%5Cfrac%7B1%7D%7B2%7D)è¡¨ç¤ºå¯¹æ€»çš„è¯¯å·®å€¼å–å¹³å‡ï¼Œæ‰€ä»¥ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œè¾“å‡ºå•å…ƒå¤šå°‘ç»´ï¼Œè¯¯å·®å€¼æ±‚å¹³å‡å°±é™¤ä»¥å¤šå°‘ï¼›æœ¬æ¨¡å‹è®¾å®šä¸­ï¼Œè¾“å‡ºå€¼ä¸º2ç»´åˆ—æ•°æ®ï¼Œæ•…ç”¨è¯¯å·®å€¼é™¤ä»¥2ã€‚**ä¸€èˆ¬æƒ…å†µä¸‹ï¼ŒæŸå¤±å‡½æ•°çš„æœŸæœ›å€¼è¡¨ç¤ºä¸ºï¼š**

â€‹                                 **![E(\theta )=\frac{1}{n}\sum_{i=1}^{n}(y_{i}-\hat{y_{i}})^{2}](https://private.codecogs.com/gif.latex?E%28%5Ctheta%20%29%3D%5Cfrac%7B1%7D%7Bn%7D%5Csum_%7Bi%3D1%7D%5E%7Bn%7D%28y_%7Bi%7D-%5Chat%7By_%7Bi%7D%7D%29%5E%7B2%7D)**                         ï¼ˆ3-6-1ï¼‰

â€‹    è¿™æ˜¯ä¸€ç»„nç»´æ•°æ®çš„è¾“å‡ºï¼Œè‹¥æ˜¯æœ‰mç»„è¿™æ ·çš„æ•°æ®ï¼ŒæŸå¤±å‡½æ•°çš„æœŸæœ›å€¼ä¸ºï¼š

â€‹                               **![E(\theta )=\frac{1}{m}\frac{1}{n}\sum_{j=1}^{m}\sum_{i=1}^{n}(y_{ji}-\hat{y}_{ji})^{2}](https://private.codecogs.com/gif.latex?E%28%5Ctheta%20%29%3D%5Cfrac%7B1%7D%7Bm%7D%5Cfrac%7B1%7D%7Bn%7D%5Csum_%7Bj%3D1%7D%5E%7Bm%7D%5Csum_%7Bi%3D1%7D%5E%7Bn%7D%28y_%7Bji%7D-%5Chat%7By%7D_%7Bji%7D%29%5E%7B2%7D)**                   ï¼ˆ3-6-2ï¼‰

â€‹    è‹¥çœŸå®å€¼ä¸è¾“å‡ºå€¼è¡¨ç¤ºä¸º![y_{n\times m},\hat{y}_{n\times m}](https://private.codecogs.com/gif.latex?y_%7Bn%5Ctimes%20m%7D%2C%5Chat%7By%7D_%7Bn%5Ctimes%20m%7D)ï¼Œä¸Šå¼å¯è¡¨ç¤ºä¸ºï¼š

â€‹                                 ![E(\theta )=\frac{1}{mn}(y-\hat{y})^T(y-\hat{y})](https://private.codecogs.com/gif.latex?E%28%5Ctheta%20%29%3D%5Cfrac%7B1%7D%7Bmn%7D%28y-%5Chat%7By%7D%29%5ET%28y-%5Chat%7By%7D%29)                    ï¼ˆ3-6-3ï¼‰

â€‹    ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œè¾“å‡ºæ•°æ®ä¸º1ç»´æˆ–æ˜¯2ç»´ï¼Œè¾“å‡ºçš„æ•°æ®æœ‰å¤šç»„ã€‚

  

**3ï¼‰**æ ¹æ®æŸå¤±å‡½æ•°ï¼Œè®¡ç®—è¾“å‡ºå•å…ƒçš„è¯¯å·®é¡¹å’Œéšè—å•å…ƒçš„è¯¯å·®é¡¹

è¾“å‡ºå•å…ƒçš„è¯¯å·®é¡¹ï¼Œå³è®¡ç®—æŸå¤±å‡½æ•°å…³äºè¾“å‡ºå•å…ƒçš„æ¢¯åº¦å€¼æˆ–åå¯¼æ•°ï¼Œæ ¹æ®é“¾å¼æ³•åˆ™æœ‰ï¼š

â€‹                              **![\bigtriangledown _{(k)}v=\frac{\partial E}{\partial v}=\frac{\partial net_{2}}{\partial v}\frac{\partial \hat{y}}{\partial net_{2}}\frac{\partial E}{\partial \hat{y}}](https://private.codecogs.com/gif.latex?%5Cbigtriangledown%20_%7B%28k%29%7Dv%3D%5Cfrac%7B%5Cpartial%20E%7D%7B%5Cpartial%20v%7D%3D%5Cfrac%7B%5Cpartial%20net_%7B2%7D%7D%7B%5Cpartial%20v%7D%5Cfrac%7B%5Cpartial%20%5Chat%7By%7D%7D%7B%5Cpartial%20net_%7B2%7D%7D%5Cfrac%7B%5Cpartial%20E%7D%7B%5Cpartial%20%5Chat%7By%7D%7D)**    

â€‹                             ![\bigtriangledown _{(k)}b_{2}=\frac{\partial E}{\partial b_{2}}=\frac{\partial net_{2}}{\partial b_{2}}\frac{\partial \hat{y}}{\partial net_{2}}\frac{\partial E}{\partial \hat{y}}](https://private.codecogs.com/gif.latex?%5Cbigtriangledown%20_%7B%28k%29%7Db_%7B2%7D%3D%5Cfrac%7B%5Cpartial%20E%7D%7B%5Cpartial%20b_%7B2%7D%7D%3D%5Cfrac%7B%5Cpartial%20net_%7B2%7D%7D%7B%5Cpartial%20b_%7B2%7D%7D%5Cfrac%7B%5Cpartial%20%5Chat%7By%7D%7D%7B%5Cpartial%20net_%7B2%7D%7D%5Cfrac%7B%5Cpartial%20E%7D%7B%5Cpartial%20%5Chat%7By%7D%7D)                    ï¼ˆ3-7ï¼‰

éšè—å•å…ƒçš„è¯¯å·®é¡¹ï¼Œå³è®¡ç®—æŸå¤±å‡½æ•°å…³äºéšè—å•å…ƒçš„æ¢¯åº¦å€¼æˆ–åå¯¼æ•°ï¼Œæ ¹æ®é“¾å¼æ³•åˆ™æœ‰ï¼š

â€‹                          **![\bigtriangledown _{(k)}w=\frac{\partial E}{\partial w}=\frac{\partial net_{1}}{\partial w}\frac{\partial h}{\partial net_{1}}\frac{\partial net_{2}}{\partial h}\frac{\partial \hat{y}}{\partial net_{2}}\frac{\partial E}{\partial \hat{y}}](https://private.codecogs.com/gif.latex?%5Cbigtriangledown%20_%7B%28k%29%7Dw%3D%5Cfrac%7B%5Cpartial%20E%7D%7B%5Cpartial%20w%7D%3D%5Cfrac%7B%5Cpartial%20net_%7B1%7D%7D%7B%5Cpartial%20w%7D%5Cfrac%7B%5Cpartial%20h%7D%7B%5Cpartial%20net_%7B1%7D%7D%5Cfrac%7B%5Cpartial%20net_%7B2%7D%7D%7B%5Cpartial%20h%7D%5Cfrac%7B%5Cpartial%20%5Chat%7By%7D%7D%7B%5Cpartial%20net_%7B2%7D%7D%5Cfrac%7B%5Cpartial%20E%7D%7B%5Cpartial%20%5Chat%7By%7D%7D)**            

â€‹                          **![\bigtriangledown _{(k)}b_{1}=\frac{\partial E}{\partial b_{1}}=\frac{\partial net_{1}}{\partial b_{1}}\frac{\partial h}{\partial net_{1}}\frac{\partial net_{2}}{\partial h}\frac{\partial \hat{y}}{\partial net_{2}}\frac{\partial E}{\partial \hat{y}}](https://private.codecogs.com/gif.latex?%5Cbigtriangledown%20_%7B%28k%29%7Db_%7B1%7D%3D%5Cfrac%7B%5Cpartial%20E%7D%7B%5Cpartial%20b_%7B1%7D%7D%3D%5Cfrac%7B%5Cpartial%20net_%7B1%7D%7D%7B%5Cpartial%20b_%7B1%7D%7D%5Cfrac%7B%5Cpartial%20h%7D%7B%5Cpartial%20net_%7B1%7D%7D%5Cfrac%7B%5Cpartial%20net_%7B2%7D%7D%7B%5Cpartial%20h%7D%5Cfrac%7B%5Cpartial%20%5Chat%7By%7D%7D%7B%5Cpartial%20net_%7B2%7D%7D%5Cfrac%7B%5Cpartial%20E%7D%7B%5Cpartial%20%5Chat%7By%7D%7D)**            ï¼ˆ3-8ï¼‰

 **PS:** å¯¹äºå¤åˆå‡½æ•°ä¸­çš„å‘é‡æˆ–çŸ©é˜µæ±‚åå¯¼ï¼Œå¤åˆå‡½æ•°å†…éƒ¨å‡½æ•°çš„åå¯¼æ€»æ˜¯å·¦ä¹˜ï¼›å¯¹äºå¤åˆå‡½æ•°ä¸­çš„æ ‡é‡æ±‚åå¯¼ï¼Œå¤åˆå‡½æ•°å†…éƒ¨å‡½æ•°çš„åå¯¼å·¦ä¹˜æˆ–è€…å³ä¹˜éƒ½å¯ä»¥ã€‚



 **4ï¼‰** æ›´æ–°ç¥ç»ç½‘è·¯ä¸­çš„æƒå€¼å’Œåç½®é¡¹

 è¾“å‡ºå•å…ƒå‚æ•°æ›´æ–°ï¼š       ![v^{(k)}=v^{(k-1)}-\eta \bigtriangledown _{(k)}v=v^{(k-1)}-\eta \frac{\partial E}{\partial v}, b_{2}^{(k)}=b_{2}^{(k-1)}-\eta \frac{\partial E}{\partial b_{2}}](https://private.codecogs.com/gif.latex?v%5E%7B%28k%29%7D%3Dv%5E%7B%28k-1%29%7D-%5Ceta%20%5Cbigtriangledown%20_%7B%28k%29%7Dv%3Dv%5E%7B%28k-1%29%7D-%5Ceta%20%5Cfrac%7B%5Cpartial%20E%7D%7B%5Cpartial%20v%7D%2C%20b_%7B2%7D%5E%7B%28k%29%7D%3Db_%7B2%7D%5E%7B%28k-1%29%7D-%5Ceta%20%5Cfrac%7B%5Cpartial%20E%7D%7B%5Cpartial%20b_%7B2%7D%7D)             ï¼ˆ3-9ï¼‰

 éšè—å•å…ƒå‚æ•°æ›´æ–°ï¼š       ![w^{(k)}=w^{(k-1)}-\eta \bigtriangledown _{(k)}w=w^{(k-1)}-\eta \frac{\partial E}{\partial w}, b_{1}^{(k)}=b_{1}^{(k-1)}-\eta \frac{\partial E}{\partial b_{1}}](https://private.codecogs.com/gif.latex?w%5E%7B%28k%29%7D%3Dw%5E%7B%28k-1%29%7D-%5Ceta%20%5Cbigtriangledown%20_%7B%28k%29%7Dw%3Dw%5E%7B%28k-1%29%7D-%5Ceta%20%5Cfrac%7B%5Cpartial%20E%7D%7B%5Cpartial%20w%7D%2C%20b_%7B1%7D%5E%7B%28k%29%7D%3Db_%7B1%7D%5E%7B%28k-1%29%7D-%5Ceta%20%5Cfrac%7B%5Cpartial%20E%7D%7B%5Cpartial%20b_%7B1%7D%7D)            ï¼ˆ3-10ï¼‰   

 å…¶ä¸­ï¼Œ![\eta](https://private.codecogs.com/gif.latex?%5Ceta)è¡¨ç¤ºå­¦ä¹ ç‡**ï¼Œ**k=1,2,...,nè¡¨ç¤ºæ›´æ–°æ¬¡æ•°æˆ–è¿­ä»£æ¬¡æ•°ï¼Œk=1è¡¨ç¤ºç¬¬ä¸€æ¬¡æ›´æ–°ï¼Œä»¥æ­¤ç±»æ¨ã€‚æ­¤å¤„å¯èƒ½å’Œåˆ«å¤„åšå®¢ä¸å¤ªä¸€æ ·ï¼Œä½†å®è´¨æ˜¯ä¸€æ ·çš„ï¼Œæ­¤å¤„çš„'+'æˆ–è€…'-'ä¸»è¦å–å†³äºæŸå¤±å‡½æ•°.

å¦‚ä½•å®šä¹‰æŸå¤±å‡½æ•°æˆ–è€…å®šä¹‰å‚æ•°æ›´æ–°å‡å¯ï¼Œä½†å‚æ•°çš„æ›´æ–°ä¸€å®šæ˜¯å‘å‚æ•°çš„è´Ÿæ¢¯åº¦æ–¹å‘ã€‚

 

**5ï¼‰** é‡å¤æ­¥éª¤2-4ï¼Œç›´åˆ°æŸå¤±å‡½æ•°å°äºäº‹å…ˆç»™å®šçš„é˜ˆå€¼æˆ–è¿­ä»£æ¬¡æ•°ç”¨å®Œä¸ºæ­¢ï¼Œè¾“å‡ºæ­¤æ—¶çš„å‚æ•°å³ä¸ºç›®å‰æœ€ä½³å‚æ•°ã€‚



#### 2.3.2 è¯¦ç»†æ­¥éª¤

**è¿™ä¾¿æ˜¯BPç®—æ³•çš„ä¸€ä¸ªå…·ä½“æ­¥éª¤ï¼Œä¸‹é¢æˆ‘ä»¬è¯¦ç»†ä»‹ç»BPç®—æ³•æ­¥éª¤ä¸­çš„æ¯ä¸€æ­¥**ï¼š



#####  **æ­¥éª¤1ï¼‰**

åˆå§‹åŒ–å‚æ•°å€¼(è¾“å‡ºå•å…ƒæƒå€¼ã€åç½®é¡¹å’Œéšè—å•å…ƒæƒå€¼ã€åç½®é¡¹å‡ä¸ºæ¨¡å‹çš„å‚æ•°)ï¼Œæ˜¯ä¸ºæ¿€æ´»å‰å‘ä¼ æ’­ï¼Œå¾—åˆ°æ¯ä¸€å±‚å…ƒç´ çš„è¾“å‡ºå€¼ï¼Œè¿›è€Œå¾—åˆ°æŸå¤±å‡½æ•°çš„å€¼ã€‚å‚æ•°åˆå§‹åŒ–ï¼Œå¯ä»¥è‡ªå·±è®¾å®šï¼Œä¹Ÿå¯ä»¥é€‰æ‹©éšæœºç”Ÿæˆï¼›ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œè‡ªå·±å†™ä»£ç æˆ–è€…è°ƒç”¨tensorflowæˆ–kerasæ—¶ï¼Œéƒ½æ˜¯éšæœºç”Ÿæˆå‚æ•°ã€‚å› ä¸ºåˆå§‹å‚æ•°å¯¹æœ€ç»ˆçš„å‚æ•°å½±å“ä¸å¤§ï¼Œåªä¼šå½±å“è¿­ä»£çš„æ¬¡æ•°ã€‚



##### **æ­¥éª¤2ï¼‰**

åœ¨æ­¥éª¤1çš„åŸºç¡€ä¸Šï¼Œæ¿€æ´»å‰å‘ä¼ æ’­ï¼Œå¾—åˆ°![net_{1},h,net_{2},\hat{y}](https://private.codecogs.com/gif.latex?net_%7B1%7D%2Ch%2Cnet_%7B2%7D%2C%5Chat%7By%7D)çš„å€¼ï¼Œè¿›è€Œå¾—åˆ°çš„å€¼ï¼›å…¶ä¸­çš„è®¡ç®—ï¼Œæ ¹æ®å‰é¢æ¨¡å‹è®¾å®šä¸­çš„å…¬å¼è®¡ç®—ã€‚è®¡ç®—è¿™äº›å€¼æ˜¯ä¸ºè®¡ç®—æ­¥éª¤3ä¸­çš„è¯¯å·®é¡¹ã€‚



#####  **æ­¥éª¤3ï¼‰**

è®¡ç®—å„é¡¹è¯¯å·®ï¼Œå³è®¡ç®—å‚æ•°å…³äºæŸå¤±å‡½æ•°çš„æ¢¯åº¦æˆ–åå¯¼æ•°ï¼Œä¹‹æ‰€ä»¥ç§°ä¹‹ä¸ºè¯¯å·®ï¼Œæ˜¯å› ä¸ºæŸå¤±å‡½æ•°æœ¬èº«ä¸ºçœŸå®å€¼ä¸é¢„æµ‹å€¼ä¹‹é—´çš„å·®å¼‚ã€‚è®¡ç®—å‚æ•°çš„åå¯¼æ•°ï¼Œæ ¹æ®çš„æ˜¯å¾®ç§¯åˆ†ä¸­çš„é“¾å¼æ³•åˆ™ã€‚å…·ä½“æ¨å¯¼å¦‚ä¸‹ï¼š

###### **è¾“å‡ºå•å…ƒçš„è¯¯å·®é¡¹**

**è¾“å‡ºå•å…ƒçš„è¯¯å·®é¡¹**ï¼šè¾“å‡ºå•å…ƒvä¸æŸå¤±å‡½æ•°Eï¼Œä¸æ˜¯ç›´æ¥ç›¸å…³ï¼Œè€Œæ˜¯é€šè¿‡å¤åˆå‡½æ•°çš„å½¢å¼å…³è”ï¼Œä»¥è®¾å®šçš„æ¨¡å‹ä¸ºä¾‹ï¼š

  ![E(v,b_{2})=\frac{1}{2}\sum_{i=1}^{2}(y_{i}-\hat{y_{i}})^{2}=\frac{1}{2}(y-\hat{y})^T(y-\hat{y})](https://private.codecogs.com/gif.latex?E%28v%2Cb_%7B2%7D%29%3D%5Cfrac%7B1%7D%7B2%7D%5Csum_%7Bi%3D1%7D%5E%7B2%7D%28y_%7Bi%7D-%5Chat%7By_%7Bi%7D%7D%29%5E%7B2%7D%3D%5Cfrac%7B1%7D%7B2%7D%28y-%5Chat%7By%7D%29%5ET%28y-%5Chat%7By%7D%29)   

â€‹                                  ![=\frac{1}{2}(y-\hat{y}(net_{2}(v,b_{2})))^T(y-\hat{y}(net_{2}(v,b_{2}))](https://private.codecogs.com/gif.latex?%3D%5Cfrac%7B1%7D%7B2%7D%28y-%5Chat%7By%7D%28net_%7B2%7D%28v%2Cb_%7B2%7D%29%29%29%5ET%28y-%5Chat%7By%7D%28net_%7B2%7D%28v%2Cb_%7B2%7D%29%29)      ï¼ˆ3-11ï¼‰

å…¶ä¸­![E(v,b_{2})](https://private.codecogs.com/gif.latex?E%28v%2Cb_%7B2%7D%29)è¡¨ç¤ºæŸå¤±å‡½æ•°åŒ–ä¸ºä¸å‚æ•°vï¼Œb2ç›¸å…³çš„è¡¨è¾¾å¼ã€‚

æ ¹æ®é“¾å¼æ³•åˆ™ï¼Œè¾“å‡ºå•å…ƒvä¸æŸå¤±å‡½æ•°Eçš„è¯¯å·®é¡¹ä¸ºï¼š                

â€‹                              **![\bigtriangledown _{(k)}v=\frac{\partial E}{\partial v}=\frac{\partial net_{2}}{\partial v}\frac{\partial \hat{y}}{\partial net_{2}}\frac{\partial E}{\partial \hat{y}}](https://private.codecogs.com/gif.latex?%5Cbigtriangledown%20_%7B%28k%29%7Dv%3D%5Cfrac%7B%5Cpartial%20E%7D%7B%5Cpartial%20v%7D%3D%5Cfrac%7B%5Cpartial%20net_%7B2%7D%7D%7B%5Cpartial%20v%7D%5Cfrac%7B%5Cpartial%20%5Chat%7By%7D%7D%7B%5Cpartial%20net_%7B2%7D%7D%5Cfrac%7B%5Cpartial%20E%7D%7B%5Cpartial%20%5Chat%7By%7D%7D)**

â€‹                              ![\bigtriangledown _{(k)}b_{2}=\frac{\partial E}{\partial b_{2}}=\frac{\partial net_{2}}{\partial b_{2}}\frac{\partial \hat{y}}{\partial net_{2}}\frac{\partial E}{\partial \hat{y}}](https://private.codecogs.com/gif.latex?%5Cbigtriangledown%20_%7B%28k%29%7Db_%7B2%7D%3D%5Cfrac%7B%5Cpartial%20E%7D%7B%5Cpartial%20b_%7B2%7D%7D%3D%5Cfrac%7B%5Cpartial%20net_%7B2%7D%7D%7B%5Cpartial%20b_%7B2%7D%7D%5Cfrac%7B%5Cpartial%20%5Chat%7By%7D%7D%7B%5Cpartial%20net_%7B2%7D%7D%5Cfrac%7B%5Cpartial%20E%7D%7B%5Cpartial%20%5Chat%7By%7D%7D)                     ï¼ˆ3-12ï¼‰

æ±‚å‡ºä¸Šå¼ä¸­æ¯ä¸€ä¸ªåå¯¼ï¼š

â€‹                    ![\frac{\partial E}{\partial \hat{y}}=\frac{1}{2\partial \hat{y}}\partial ((y-\hat{y})^T(y-\hat{y}))=\frac{1}{2\partial \hat{y}}\partial (y^Ty-y^T\hat{y}-\hat{y}^Ty+\hat{y}^T\hat{y})](https://private.codecogs.com/gif.latex?%5Cfrac%7B%5Cpartial%20E%7D%7B%5Cpartial%20%5Chat%7By%7D%7D%3D%5Cfrac%7B1%7D%7B2%5Cpartial%20%5Chat%7By%7D%7D%5Cpartial%20%28%28y-%5Chat%7By%7D%29%5ET%28y-%5Chat%7By%7D%29%29%3D%5Cfrac%7B1%7D%7B2%5Cpartial%20%5Chat%7By%7D%7D%5Cpartial%20%28y%5ETy-y%5ET%5Chat%7By%7D-%5Chat%7By%7D%5ETy&plus;%5Chat%7By%7D%5ET%5Chat%7By%7D%29)

â€‹                        ![=\frac{1}{2}(-y-y+\hat{y}+\hat{y})=\hat{y}-y](https://private.codecogs.com/gif.latex?%3D%5Cfrac%7B1%7D%7B2%7D%28-y-y&plus;%5Chat%7By%7D&plus;%5Chat%7By%7D%29%3D%5Chat%7By%7D-y)                              ï¼ˆ3-13ï¼‰

â€‹                                   ![\frac{\partial \hat{y}}{\partial net_{2}}=\frac{\partial g_{2}(net_{2})}{\partial net_{2}}](https://private.codecogs.com/gif.latex?%5Cfrac%7B%5Cpartial%20%5Chat%7By%7D%7D%7B%5Cpartial%20net_%7B2%7D%7D%3D%5Cfrac%7B%5Cpartial%20g_%7B2%7D%28net_%7B2%7D%29%7D%7B%5Cpartial%20net_%7B2%7D%7D)                            ï¼ˆ3-14ï¼‰

â€‹                                ![\frac{\partial net_{2}}{\partial v}=\frac{\partial (v^Th+b_{2})}{\partial v}=h](https://private.codecogs.com/gif.latex?%5Cfrac%7B%5Cpartial%20net_%7B2%7D%7D%7B%5Cpartial%20v%7D%3D%5Cfrac%7B%5Cpartial%20%28v%5ETh&plus;b_%7B2%7D%29%7D%7B%5Cpartial%20v%7D%3Dh)                         ï¼ˆ3-15ï¼‰

â€‹                              ![\frac{\partial net_{2}}{\partial b_{2}}=\frac{\partial (v^Th+b_{2})}{\partial b_{2}}=\begin{pmatrix} 1\\ 1\end{pmatrix}^T](https://private.codecogs.com/gif.latex?%5Cfrac%7B%5Cpartial%20net_%7B2%7D%7D%7B%5Cpartial%20b_%7B2%7D%7D%3D%5Cfrac%7B%5Cpartial%20%28v%5ETh&plus;b_%7B2%7D%29%7D%7B%5Cpartial%20b_%7B2%7D%7D%3D%5Cbegin%7Bpmatrix%7D%201%5C%5C%201%5Cend%7Bpmatrix%7D%5ET)                        (3-16)

å…¶ä¸­ï¼Œ![net_{2}](https://private.codecogs.com/gif.latex?net_%7B2%7D)å…³äºæ¿€æ´»å‡½æ•°![g_{2}](https://private.codecogs.com/gif.latex?g_%7B2%7D)æ±‚åå¯¼ï¼Œéœ€è¦æ ¹æ®å…·ä½“çš„æ¿€æ´»å‡½æ•°è€Œå®šï¼Œæ¯ä¸€å±‚çš„æ¿€æ´»å‡½æ•°å¯ä»¥é€‰æ‹©ä¸åŒçš„å‡½æ•°ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ï¼Œä¸ºç®€å•åŒ–æ¨¡å‹è®¾è®¡å’Œæ±‚å¯¼æ–¹ä¾¿ï¼Œä¼šè®¾å®šä¸ºåŒä¸€ä¸ªå‡½æ•°ã€‚æ­¤å¤„å‡è®¾é€‰æ‹©æ¿€æ´»å‡½æ•°ä¸ºsigmoidå‡½æ•°ï¼Œé‚£ä¹ˆæœ‰ï¼š 

â€‹         ![\frac{\partial \hat{y}}{\partial net_{2}}=\frac{\partial g_{2}(net_{2})}{\partial net_{2}}=\begin{pmatrix} \partial sigmoid(net_{21})/\partial net_{21}\\ \partial sigmoid(net_{22})/\partial net_{22}\end{pmatrix}](https://private.codecogs.com/gif.latex?%5Cfrac%7B%5Cpartial%20%5Chat%7By%7D%7D%7B%5Cpartial%20net_%7B2%7D%7D%3D%5Cfrac%7B%5Cpartial%20g_%7B2%7D%28net_%7B2%7D%29%7D%7B%5Cpartial%20net_%7B2%7D%7D%3D%5Cbegin%7Bpmatrix%7D%20%5Cpartial%20sigmoid%28net_%7B21%7D%29/%5Cpartial%20net_%7B21%7D%5C%5C%20%5Cpartial%20sigmoid%28net_%7B22%7D%29/%5Cpartial%20net_%7B22%7D%5Cend%7Bpmatrix%7D)

â€‹              ![=\begin{pmatrix} \frac{1}{1+exp(-net_{21})}\times(1-\frac{1}{1+exp(-net_{21})}) \\ \frac{1}{1+exp(-net_{22})}\times(1-\frac{1}{1+exp(-net_{22})})\end{pmatrix}=\begin{pmatrix} \hat{y}_{1}(1-\hat{y}_1)\\ \hat{y}_{2}(1-\hat{y}_2)\end{pmatrix}=\hat{y}\bigodot (1-\hat{y})](https://private.codecogs.com/gif.latex?%3D%5Cbegin%7Bpmatrix%7D%20%5Cfrac%7B1%7D%7B1&plus;exp%28-net_%7B21%7D%29%7D%5Ctimes%281-%5Cfrac%7B1%7D%7B1&plus;exp%28-net_%7B21%7D%29%7D%29%20%5C%5C%20%5Cfrac%7B1%7D%7B1&plus;exp%28-net_%7B22%7D%29%7D%5Ctimes%281-%5Cfrac%7B1%7D%7B1&plus;exp%28-net_%7B22%7D%29%7D%29%5Cend%7Bpmatrix%7D%3D%5Cbegin%7Bpmatrix%7D%20%5Chat%7By%7D_%7B1%7D%281-%5Chat%7By%7D_1%29%5C%5C%20%5Chat%7By%7D_%7B2%7D%281-%5Chat%7By%7D_2%29%5Cend%7Bpmatrix%7D%3D%5Chat%7By%7D%5Cbigodot%20%281-%5Chat%7By%7D%29)   (3-17)

**PSï¼šå› ä¸ºsigmoid(z)ä¸­zæ˜¯æ ‡é‡ï¼Œå¯¹zæ±‚åå¯¼ï¼Œæœ‰ï¼š**

â€‹        ![\frac{\partial sigmoid(z)}{\partial z}=\frac{\partial (1/(1+exp(-z))}{\partial z}=\frac{exp(-z)}{(1+exp(-z))^2}](https://private.codecogs.com/gif.latex?%5Cfrac%7B%5Cpartial%20sigmoid%28z%29%7D%7B%5Cpartial%20z%7D%3D%5Cfrac%7B%5Cpartial%20%281/%281&plus;exp%28-z%29%29%7D%7B%5Cpartial%20z%7D%3D%5Cfrac%7Bexp%28-z%29%7D%7B%281&plus;exp%28-z%29%29%5E2%7D)

â€‹                    ![=\frac{1}{1+exp(-z)}\times \frac{exp(-z)}{1+exp(-z)}=\frac{1}{1+exp(-z)}\times (1-\frac{1}{1+exp(-z)})](https://private.codecogs.com/gif.latex?%3D%5Cfrac%7B1%7D%7B1&plus;exp%28-z%29%7D%5Ctimes%20%5Cfrac%7Bexp%28-z%29%7D%7B1&plus;exp%28-z%29%7D%3D%5Cfrac%7B1%7D%7B1&plus;exp%28-z%29%7D%5Ctimes%20%281-%5Cfrac%7B1%7D%7B1&plus;exp%28-z%29%7D%29)   



**æœ¬æ–‡å®šä¹‰äº†zä¸ºå‘é‡ï¼Œå¯¹äºå‘é‡å°±æœ‰äº†å¼(3-17)çš„é€å…ƒç´ ç›¸ä¹˜çš„å¼å­ã€‚**

äºæ˜¯ï¼Œä¸ºç®€åŒ–åé¢çš„è®¡ç®—ï¼Œè®°

â€‹                           ![\delta ^{(k)}=\frac{\partial \hat{y}}{\partial net_{2}}\frac{\partial E}{\partial \hat{y}}=\hat{y}\odot (1-\hat{y})\odot (\hat{y}-y)](https://private.codecogs.com/gif.latex?%5Cdelta%20%5E%7B%28k%29%7D%3D%5Cfrac%7B%5Cpartial%20%5Chat%7By%7D%7D%7B%5Cpartial%20net_%7B2%7D%7D%5Cfrac%7B%5Cpartial%20E%7D%7B%5Cpartial%20%5Chat%7By%7D%7D%3D%5Chat%7By%7D%5Codot%20%281-%5Chat%7By%7D%29%5Codot%20%28%5Chat%7By%7D-y%29)                 (3-18)

å…¶ä¸­ï¼Œ![\delta ^{(k)}](https://private.codecogs.com/gif.latex?%5Cdelta%20%5E%7B%28k%29%7D)è¡¨ç¤ºç¬¬kæ¬¡æ±‚æŸå¤±å‡½æ•°å…³äº![net_{2}](https://private.codecogs.com/gif.latex?net_%7B2%7D)çš„åå¯¼ï¼›![\odot](https://private.codecogs.com/gif.latex?%5Codot)è¡¨ç¤ºé€å…ƒç´ ç›¸ä¹˜ï¼Œå³ä¸¤ä¸ªå‘é‡æˆ–ä¸¤ä¸ªçŸ©é˜µå¯¹åº”çš„å…ƒç´ ç›¸ä¹˜ï¼Œä¾‹å¦‚ï¼š   

â€‹                          ![\begin{pmatrix} a_{11} &a_{12} \\ a_{21} &a_{22}} \end{pmatrix}\odot \begin{pmatrix} b_{11} &b_{12} \\ b_{21} &b_{22}} \end{pmatrix}=\begin{pmatrix} a_{11}b_{11} &a_{12}b_{12} \\ a_{21}b_{21} &a_{22}b_{22}} \end{pmatrix}](https://private.codecogs.com/gif.latex?%5Cbegin%7Bpmatrix%7D%20a_%7B11%7D%20%26a_%7B12%7D%20%5C%5C%20a_%7B21%7D%20%26a_%7B22%7D%7D%20%5Cend%7Bpmatrix%7D%5Codot%20%5Cbegin%7Bpmatrix%7D%20b_%7B11%7D%20%26b_%7B12%7D%20%5C%5C%20b_%7B21%7D%20%26b_%7B22%7D%7D%20%5Cend%7Bpmatrix%7D%3D%5Cbegin%7Bpmatrix%7D%20a_%7B11%7Db_%7B11%7D%20%26a_%7B12%7Db_%7B12%7D%20%5C%5C%20a_%7B21%7Db_%7B21%7D%20%26a_%7B22%7Db_%7B22%7D%7D%20%5Cend%7Bpmatrix%7D)

äºæ˜¯ï¼Œ**è¾“å‡ºå•å…ƒçš„è¯¯å·®é¡¹**ä¸ºï¼š

â€‹                                   ![\bigtriangledown _{(k)}v=\frac{\partial E}{\partial v}=h\cdot \delta ^{(k)T}](https://private.codecogs.com/gif.latex?%5Cbigtriangledown%20_%7B%28k%29%7Dv%3D%5Cfrac%7B%5Cpartial%20E%7D%7B%5Cpartial%20v%7D%3Dh%5Ccdot%20%5Cdelta%20%5E%7B%28k%29T%7D)                      (3-19)

â€‹                                ![\bigtriangledown _{(k)}b_{2}=\frac{\partial E}{\partial b_{2}}=\begin{pmatrix} 1\\ 1\end{pmatrix}\odot \delta ^{(k)}=\delta ^{(k)}](https://private.codecogs.com/gif.latex?%5Cbigtriangledown%20_%7B%28k%29%7Db_%7B2%7D%3D%5Cfrac%7B%5Cpartial%20E%7D%7B%5Cpartial%20b_%7B2%7D%7D%3D%5Cbegin%7Bpmatrix%7D%201%5C%5C%201%5Cend%7Bpmatrix%7D%5Codot%20%5Cdelta%20%5E%7B%28k%29%7D%3D%5Cdelta%20%5E%7B%28k%29%7D)                (3-20)

**æ­¤å¤„è¯´æ˜**ï¼šè‹¥é‡å¼(3-15)çš„åå¯¼(å¯¹æƒå€¼æ±‚åå¯¼)ï¼Œé“¾å¼æ³•åˆ™å¤„ç†æ–¹å¼å‡å¦‚å¼(3-19)ï¼›è‹¥é‡å¼(3-16)çš„åå¯¼(å¯¹åç½®é¡¹æ±‚åå¯¼)ï¼Œé“¾å¼æ³•åˆ™å¤„ç†æ–¹å¼å‡å¦‚å¼(3-20)ã€‚



###### éšè—å•å…ƒçš„è¯¯å·®é¡¹

**éšè—å•å…ƒçš„è¯¯å·®é¡¹ï¼š**éšè—å•å…ƒwä¸æŸå¤±å‡½æ•°Eï¼Œé€šè¿‡å¤åˆå‡½æ•°çš„å½¢å¼å…³è”ï¼Œä»¥è®¾å®šçš„æ¨¡å‹æ•´ç†ä¸ºï¼š

â€‹     **![E(w,b_{1})=\frac{1}{2}(y-\hat{y})^{T}(y-\hat{y})](https://private.codecogs.com/gif.latex?E%28w%2Cb_%7B1%7D%29%3D%5Cfrac%7B1%7D%7B2%7D%28y-%5Chat%7By%7D%29%5E%7BT%7D%28y-%5Chat%7By%7D%29)**

â€‹             **![=\frac{1}{2}(y-\hat{y}(net_{2}(h(net_{1}(w,b_{1}),b_{2}))))^T(y-\hat{y}(net_{2}(h(net_{1}(w,b_{1}),b_{2})))))](https://private.codecogs.com/gif.latex?%3D%5Cfrac%7B1%7D%7B2%7D%28y-%5Chat%7By%7D%28net_%7B2%7D%28h%28net_%7B1%7D%28w%2Cb_%7B1%7D%29%2Cb_%7B2%7D%29%29%29%29%5ET%28y-%5Chat%7By%7D%28net_%7B2%7D%28h%28net_%7B1%7D%28w%2Cb_%7B1%7D%29%2Cb_%7B2%7D%29%29%29%29%29)** ï¼ˆ3-21ï¼‰

æ ¹æ®é“¾å¼æ³•åˆ™ï¼Œéšè—å•å…ƒwä¸æŸå¤±å‡½æ•°Eçš„è¯¯å·®é¡¹ä¸ºï¼š

â€‹                        **![\bigtriangledown _{(k)}w=\frac{\partial E}{\partial w}=\frac{\partial net_{1}}{\partial w}\frac{\partial h}{\partial net_{1}}\frac{\partial net_{2}}{\partial h}\frac{\partial \hat{y}}{\partial net_{2}}\frac{\partial E}{\partial \hat{y}}](https://private.codecogs.com/gif.latex?%5Cbigtriangledown%20_%7B%28k%29%7Dw%3D%5Cfrac%7B%5Cpartial%20E%7D%7B%5Cpartial%20w%7D%3D%5Cfrac%7B%5Cpartial%20net_%7B1%7D%7D%7B%5Cpartial%20w%7D%5Cfrac%7B%5Cpartial%20h%7D%7B%5Cpartial%20net_%7B1%7D%7D%5Cfrac%7B%5Cpartial%20net_%7B2%7D%7D%7B%5Cpartial%20h%7D%5Cfrac%7B%5Cpartial%20%5Chat%7By%7D%7D%7B%5Cpartial%20net_%7B2%7D%7D%5Cfrac%7B%5Cpartial%20E%7D%7B%5Cpartial%20%5Chat%7By%7D%7D)**

â€‹                       **![\bigtriangledown _{(k)}b_{1}=\frac{\partial E}{\partial b_{1}}=\frac{\partial net_{1}}{\partial b_{1}}\frac{\partial h}{\partial net_{1}}\frac{\partial net_{2}}{\partial h}\frac{\partial \hat{y}}{\partial net_{2}}\frac{\partial E}{\partial \hat{y}}](https://private.codecogs.com/gif.latex?%5Cbigtriangledown%20_%7B%28k%29%7Db_%7B1%7D%3D%5Cfrac%7B%5Cpartial%20E%7D%7B%5Cpartial%20b_%7B1%7D%7D%3D%5Cfrac%7B%5Cpartial%20net_%7B1%7D%7D%7B%5Cpartial%20b_%7B1%7D%7D%5Cfrac%7B%5Cpartial%20h%7D%7B%5Cpartial%20net_%7B1%7D%7D%5Cfrac%7B%5Cpartial%20net_%7B2%7D%7D%7B%5Cpartial%20h%7D%5Cfrac%7B%5Cpartial%20%5Chat%7By%7D%7D%7B%5Cpartial%20net_%7B2%7D%7D%5Cfrac%7B%5Cpartial%20E%7D%7B%5Cpartial%20%5Chat%7By%7D%7D)**            ï¼ˆ3-22ï¼‰

åŒæ ·çš„æ±‚å¯¼æ³•åˆ™ï¼Œå¾—åˆ°**éšè—å•å…ƒçš„è¯¯å·®é¡¹**ä¸ºï¼š

â€‹                      ![\bigtriangledown _{(k)}w=\frac{\partial E}{\partial w}=x\cdot (h\odot (1-h)\odot (v-\delta ^{(K)}))^T](https://private.codecogs.com/gif.latex?%5Cbigtriangledown%20_%7B%28k%29%7Dw%3D%5Cfrac%7B%5Cpartial%20E%7D%7B%5Cpartial%20w%7D%3Dx%5Ccdot%20%28h%5Codot%20%281-h%29%5Codot%20%28v-%5Cdelta%20%5E%7B%28K%29%7D%29%29%5ET)            ï¼ˆ3-23ï¼‰

â€‹          ![\bigtriangledown _{(k)}b_{1}=\frac{\partial E}{\partial b_{1}}=\begin{pmatrix} 1\\ 1\\ ...\\ 1 \end{pmatrix}\odot (h\odot (1-h)\odot (v\cdot \delta ^{(k)}))=h\odot (1-h)\odot (v\cdot \delta ^{(k)}))](https://private.codecogs.com/gif.latex?%5Cbigtriangledown%20_%7B%28k%29%7Db_%7B1%7D%3D%5Cfrac%7B%5Cpartial%20E%7D%7B%5Cpartial%20b_%7B1%7D%7D%3D%5Cbegin%7Bpmatrix%7D%201%5C%5C%201%5C%5C%20...%5C%5C%201%20%5Cend%7Bpmatrix%7D%5Codot%20%28h%5Codot%20%281-h%29%5Codot%20%28v%5Ccdot%20%5Cdelta%20%5E%7B%28k%29%7D%29%29%3Dh%5Codot%20%281-h%29%5Codot%20%28v%5Ccdot%20%5Cdelta%20%5E%7B%28k%29%7D%29%29)ï¼ˆ3-24ï¼‰

   å…¶ä¸­ï¼š

â€‹                                   ![\frac{\partial net_{2}}{\partial h}=\frac{\partial (v^{T}h+b_{2})}{\partial h}=v](https://private.codecogs.com/gif.latex?%5Cfrac%7B%5Cpartial%20net_%7B2%7D%7D%7B%5Cpartial%20h%7D%3D%5Cfrac%7B%5Cpartial%20%28v%5E%7BT%7Dh&plus;b_%7B2%7D%29%7D%7B%5Cpartial%20h%7D%3Dv)                 ï¼ˆ3-25ï¼‰

â€‹                             ![\frac{\partial h}{\partial net_{1}}=\frac{\partial (sigmoid(net_{1}))}{\partial net_{1}}=h\odot (1-h)](https://private.codecogs.com/gif.latex?%5Cfrac%7B%5Cpartial%20h%7D%7B%5Cpartial%20net_%7B1%7D%7D%3D%5Cfrac%7B%5Cpartial%20%28sigmoid%28net_%7B1%7D%29%29%7D%7B%5Cpartial%20net_%7B1%7D%7D%3Dh%5Codot%20%281-h%29)          (3-26)

â€‹                                  ![\frac{\partial net_{1}}{\partial w}=\frac{(w^Tx+b_{1})}{\partial w}=x](https://private.codecogs.com/gif.latex?%5Cfrac%7B%5Cpartial%20net_%7B1%7D%7D%7B%5Cpartial%20w%7D%3D%5Cfrac%7B%28w%5ETx&plus;b_%7B1%7D%29%7D%7B%5Cpartial%20w%7D%3Dx)                   (3-27)

â€‹                                 ![\frac{\partial net_{1}}{\partial b_{1}}=\frac{\partial (w^Tx+b)}{\partial b_{1}}=\begin{pmatrix} 1\\ 1\\... \\ 1 \end{pmatrix}^T](https://private.codecogs.com/gif.latex?%5Cfrac%7B%5Cpartial%20net_%7B1%7D%7D%7B%5Cpartial%20b_%7B1%7D%7D%3D%5Cfrac%7B%5Cpartial%20%28w%5ETx&plus;b%29%7D%7B%5Cpartial%20b_%7B1%7D%7D%3D%5Cbegin%7Bpmatrix%7D%201%5C%5C%201%5C%5C...%20%5C%5C%201%20%5Cend%7Bpmatrix%7D%5ET)                (3-28)

 **è¯´æ˜**ï¼šè‹¥é‡å¼(3-25)(å¯¹éšè—å•å…ƒæ±‚åå¯¼)ï¼Œé“¾å¼æ³•åˆ™å¤„ç†å¦‚å¼(3-23)ï¼›å¼(3-15)å’Œ(3-26)åŒï¼Œæ•…æœ‰ç›¸åŒçš„å¤„ç†æ–¹å¼ï¼›å¼(3-16)å’Œ(3-27)åŒï¼Œæ•…æœ‰ç›¸åŒçš„å¤„ç†æ–¹å¼ã€‚

 **è¡¥å……**ï¼šè‹¥æœ‰å¤šä¸ªéšè—å±‚æ—¶ï¼Œé€æ­¥è®¡ç®—éšè—å±‚çš„æƒå€¼å’Œåç½®é¡¹è¯¯å·®ï¼Œæ¨å¯¼çš„è§„åˆ™åŒä¸Šã€‚ä¾‹å¦‚ï¼šä¸€ä¸ªéšè—å±‚ä¸º2ï¼Œéšè—å•å…ƒä¸º5çš„ç¥ç»ç½‘ç»œï¼š

â€‹                        

![img](imgs/63a.png)

è¾“å‡ºå±‚åˆ°éšè—å±‚2çš„è¯¯å·®é¡¹åŒå¼(3-19)

éšè—å±‚2åˆ°éšè—å±‚1çš„è¯¯å·®é¡¹ä¸ºï¼š

â€‹                        ![\bigtriangledown _{(k)}w2=\frac{\partial E}{\partial w2}=h_{1}\cdot (h_{2}\odot (1-h_{2})\odot (v\cdot \delta ^{(k)}))^T](https://private.codecogs.com/gif.latex?%5Cbigtriangledown%20_%7B%28k%29%7Dw2%3D%5Cfrac%7B%5Cpartial%20E%7D%7B%5Cpartial%20w2%7D%3Dh_%7B1%7D%5Ccdot%20%28h_%7B2%7D%5Codot%20%281-h_%7B2%7D%29%5Codot%20%28v%5Ccdot%20%5Cdelta%20%5E%7B%28k%29%7D%29%29%5ET)              (3-29)

è®°ï¼š              

â€‹                                ![\delta _{1}^{(k)}=h_{2}\odot (1-h_{2})\odot (v\cdot \delta ^{(k)})^T](https://private.codecogs.com/gif.latex?%5Cdelta%20_%7B1%7D%5E%7B%28k%29%7D%3Dh_%7B2%7D%5Codot%20%281-h_%7B2%7D%29%5Codot%20%28v%5Ccdot%20%5Cdelta%20%5E%7B%28k%29%7D%29%5ET)                      (3-30)

éšè—å±‚1åˆ°è¾“å…¥å±‚çš„è¯¯å·®é¡¹ä¸ºï¼š

â€‹                        ![\bigtriangledown _{(k)}w1=\frac{\partial E}{\partial w1}=x\cdot (h_{1}\odot (1-h_{1})\odot (w2\cdot \delta _{1}^{(k)}))^T](https://private.codecogs.com/gif.latex?%5Cbigtriangledown%20_%7B%28k%29%7Dw1%3D%5Cfrac%7B%5Cpartial%20E%7D%7B%5Cpartial%20w1%7D%3Dx%5Ccdot%20%28h_%7B1%7D%5Codot%20%281-h_%7B1%7D%29%5Codot%20%28w2%5Ccdot%20%5Cdelta%20_%7B1%7D%5E%7B%28k%29%7D%29%29%5ET)            (3-31)

ä»ä¸Šè¿°ä¸­ï¼Œå®¹æ˜“çœ‹å‡ºï¼Œæ— è®ºå¤šå°‘å±‚éšè—å±‚ï¼Œå…¶è¯¯å·®é¡¹éƒ½æ˜¯åŒæ ·çš„ç»“æ„ã€‚

##### æ­¥éª¤4ï¼‰

 æ›´æ–°ç¥ç»ç½‘è·¯ä¸­çš„æƒå€¼å’Œåç½®é¡¹ã€‚å­¦ä¹ ç‡è‡ªå·±è®¾å®šï¼Œå­¦ä¹ ç‡å¤ªå¤§ï¼Œå®¹æ˜“è·³è¿‡æœ€ä½³çš„å‚æ•°ï¼›å­¦ä¹ ç‡å¤ªå°ï¼Œå®¹æ˜“é™·å…¥å±€éƒ¨æå°å€¼ã€‚

##### æ­¥éª¤5ï¼‰ 

è®¾å®šé˜ˆå€¼eæˆ–è€…è®¾å®šè¿­ä»£æ¬¡æ•°ï¼Œå½“æŸå¤±å‡½æ•°å€¼å°äºé˜ˆå€¼eæ—¶ï¼Œæˆ–å½“è¿­ä»£æ¬¡æ•°ç”¨å®Œæ—¶ï¼Œè¾“å‡ºæœ€ç»ˆå‚æ•°ã€‚



### **2.4 å®ä¾‹è¿ç”¨**

 ä¸ºèƒ½æ›´å¥½ç†è§£BPç®—æ³•å’ŒçŸ¥é“å¦‚ä½•è¿ç”¨BPç®—æ³•ï¼Œä¸‹é¢ä»¥ä¸€ä¸ªå®é™…çš„ä¾‹å­æ¥è¯´æ˜è¿ç”¨BPç®—æ³•çš„å…·ä½“æ“ä½œã€‚

æœ‰ä¸€ç»„æ•°æ®![X=\begin{bmatrix} 0.05\\ 0.10\end{bmatrix},Y=\begin{bmatrix} 0\\ 1\end{bmatrix}](https://private.codecogs.com/gif.latex?X%3D%5Cbegin%7Bbmatrix%7D%200.05%5C%5C%200.10%5Cend%7Bbmatrix%7D%2CY%3D%5Cbegin%7Bbmatrix%7D%200%5C%5C%201%5Cend%7Bbmatrix%7D)ï¼Œç›®çš„æ˜¯è®­ç»ƒè¿™ä¸¤ç»„æ•°æ®ï¼Œæ‰¾åˆ°è¾“å…¥Xè®¡ç®—å¾—åˆ°Yçš„é¢„æµ‹å€¼å°½å¯èƒ½æ¥è¿‘äºçœŸå®å€¼çš„å‚æ•°ã€‚è®¾å®šæ¨¡å‹ï¼šè®¾è®¡ä¸€ä¸ªéšè—å±‚ä¸º1ï¼Œéšè—å•å…ƒæ•°ä¸º2ï¼Œæ¿€æ´»å‡½æ•°ä¸ºsigmodå‡½æ•°çš„æ¨¡å‹ï¼Œè¿ç”¨åå‘ä¼ æ’­ç®—æ³•ï¼Œå¾—åˆ°å‚æ•°ã€‚ç½‘ç»œå¦‚å›¾5ï¼š

â€‹                        

![img](imgs/64a.png)

äºæ˜¯æœ‰ï¼š

â€‹                          ![x=\begin{bmatrix}x_{1}\\ x_{2}\end{bmatrix}, w=\begin{bmatrix}w_{11} &w_{12} \\ w_{21}&w_{22} \end{bmatrix}, b_{1}=\begin{bmatrix}b_{11}\\ b_{12}\end{bmatrix}, h=\begin{bmatrix}h_{1}\\ h_{2}\end{bmatrix}](https://private.codecogs.com/gif.latex?x%3D%5Cbegin%7Bbmatrix%7Dx_%7B1%7D%5C%5C%20x_%7B2%7D%5Cend%7Bbmatrix%7D%2C%20w%3D%5Cbegin%7Bbmatrix%7Dw_%7B11%7D%20%26w_%7B12%7D%20%5C%5C%20w_%7B21%7D%26w_%7B22%7D%20%5Cend%7Bbmatrix%7D%2C%20b_%7B1%7D%3D%5Cbegin%7Bbmatrix%7Db_%7B11%7D%5C%5C%20b_%7B12%7D%5Cend%7Bbmatrix%7D%2C%20h%3D%5Cbegin%7Bbmatrix%7Dh_%7B1%7D%5C%5C%20h_%7B2%7D%5Cend%7Bbmatrix%7D)

â€‹                             ![v=\begin{bmatrix}v_{11} &v_{12} \\ v_{21}&v_{22} \end{bmatrix}, b_{2}=\begin{bmatrix}b_{21}\\ b_{22}\end{bmatrix}, \hat{y}=\begin{bmatrix}\hat{y}_{1}\\ \hat{y}_{2}\end{bmatrix}](https://private.codecogs.com/gif.latex?v%3D%5Cbegin%7Bbmatrix%7Dv_%7B11%7D%20%26v_%7B12%7D%20%5C%5C%20v_%7B21%7D%26v_%7B22%7D%20%5Cend%7Bbmatrix%7D%2C%20b_%7B2%7D%3D%5Cbegin%7Bbmatrix%7Db_%7B21%7D%5C%5C%20b_%7B22%7D%5Cend%7Bbmatrix%7D%2C%20%5Chat%7By%7D%3D%5Cbegin%7Bbmatrix%7D%5Chat%7By%7D_%7B1%7D%5C%5C%20%5Chat%7By%7D_%7B2%7D%5Cend%7Bbmatrix%7D)

â€‹                            ![net_{1}=w^Tx+b_{1},h=sigmoid(net_{1})](https://private.codecogs.com/gif.latex?net_%7B1%7D%3Dw%5ETx&plus;b_%7B1%7D%2Ch%3Dsigmoid%28net_%7B1%7D%29)

â€‹                            ![net_{2}=v^Tx+b_{2},h=sigmoid(net_{2})](https://private.codecogs.com/gif.latex?net_%7B2%7D%3Dv%5ETx&plus;b_%7B2%7D%2Ch%3Dsigmoid%28net_%7B2%7D%29)                    (4-1)

æ ¹æ®BPç®—æ³•æ­¥éª¤ï¼š

 1ï¼‰åˆå§‹åŒ–ç½‘ç»œä¸­çš„æ‰€æœ‰å‚æ•°å¹¶ç»™å‡ºå­¦ä¹ ç‡![\eta](https://private.codecogs.com/gif.latex?%5Ceta)ï¼š

â€‹                    ![w=\begin{bmatrix}0.15 &0.20 \\ 0.25 &0.30 \end{bmatrix}, b_{1}=\begin{bmatrix}0.1\\ 0.1\end{bmatrix}, v=\begin{bmatrix}0.40 &0.45 \\ 0.50 &0.55 \end{bmatrix}, b_{2}=\begin{bmatrix}0.2\\ 0.2\end{bmatrix},\eta =0.5](https://private.codecogs.com/gif.latex?w%3D%5Cbegin%7Bbmatrix%7D0.15%20%260.20%20%5C%5C%200.25%20%260.30%20%5Cend%7Bbmatrix%7D%2C%20b_%7B1%7D%3D%5Cbegin%7Bbmatrix%7D0.1%5C%5C%200.1%5Cend%7Bbmatrix%7D%2C%20v%3D%5Cbegin%7Bbmatrix%7D0.40%20%260.45%20%5C%5C%200.50%20%260.55%20%5Cend%7Bbmatrix%7D%2C%20b_%7B2%7D%3D%5Cbegin%7Bbmatrix%7D0.2%5C%5C%200.2%5Cend%7Bbmatrix%7D%2C%5Ceta%20%3D0.5)

  2ï¼‰æ¿€æ´»å‰å‘ä¼ æ’­ï¼Œå°†å‚æ•°å¸¦å…¥å¼(4-1)ï¼Œå¹¶è®¡ç®—æŸå¤±å‡½æ•°ï¼š

â€‹    è¾“å…¥å±‚-->éšè—å±‚ï¼š

â€‹                         ![net_{1}=w^Tx+b_{1}=\bigl(\begin{smallmatrix} 0.15*0.05+0.25*0.1+0.1\\ 0.20*0.05+0.30*0.1+0.1 \end{smallmatrix}\bigr)=\bigl(\begin{smallmatrix} 0.1325\\ 0.1400 \end{smallmatrix}\bigr)](https://private.codecogs.com/gif.latex?net_%7B1%7D%3Dw%5ETx&plus;b_%7B1%7D%3D%5Cbigl%28%5Cbegin%7Bsmallmatrix%7D%200.15*0.05&plus;0.25*0.1&plus;0.1%5C%5C%200.20*0.05&plus;0.30*0.1&plus;0.1%20%5Cend%7Bsmallmatrix%7D%5Cbigr%29%3D%5Cbigl%28%5Cbegin%7Bsmallmatrix%7D%200.1325%5C%5C%200.1400%20%5Cend%7Bsmallmatrix%7D%5Cbigr%29)            (4-2)

â€‹                           ![h=sigmoid(net_{1})=sigmoid\bigl(\begin{smallmatrix} 0.1325\\ 0.1400\end{smallmatrix}\bigr)=\bigl(\begin{smallmatrix} 0.5331\\ 0.5349 \end{smallmatrix}\bigr)](https://private.codecogs.com/gif.latex?h%3Dsigmoid%28net_%7B1%7D%29%3Dsigmoid%5Cbigl%28%5Cbegin%7Bsmallmatrix%7D%200.1325%5C%5C%200.1400%5Cend%7Bsmallmatrix%7D%5Cbigr%29%3D%5Cbigl%28%5Cbegin%7Bsmallmatrix%7D%200.5331%5C%5C%200.5349%20%5Cend%7Bsmallmatrix%7D%5Cbigr%29)             (4-3)

â€‹     éšè—å±‚-->è¾“å‡ºå±‚ï¼š

â€‹                      ![net_{2}=v^Tx+b_{2}=\bigl(\begin{smallmatrix} 0.40*0.5331+0.5*0.5349+0.2\\ 0.45*0.5331+0.55*0.5349+0.2 \end{smallmatrix}\bigr)=\bigl(\begin{smallmatrix} 0.6807\\ 0.7341 \end{smallmatrix}\bigr)](https://private.codecogs.com/gif.latex?net_%7B2%7D%3Dv%5ETx&plus;b_%7B2%7D%3D%5Cbigl%28%5Cbegin%7Bsmallmatrix%7D%200.40*0.5331&plus;0.5*0.5349&plus;0.2%5C%5C%200.45*0.5331&plus;0.55*0.5349&plus;0.2%20%5Cend%7Bsmallmatrix%7D%5Cbigr%29%3D%5Cbigl%28%5Cbegin%7Bsmallmatrix%7D%200.6807%5C%5C%200.7341%20%5Cend%7Bsmallmatrix%7D%5Cbigr%29)        (4-4)

â€‹                         ![\hat{Y}=sigmoid(net_{2})=sigmoid\bigl(\begin{smallmatrix} 0.6807\\ 0.7341\end{smallmatrix}\bigr)=\bigl(\begin{smallmatrix} 0.6639\\ 0.6575 \end{smallmatrix}\bigr)](https://private.codecogs.com/gif.latex?%5Chat%7BY%7D%3Dsigmoid%28net_%7B2%7D%29%3Dsigmoid%5Cbigl%28%5Cbegin%7Bsmallmatrix%7D%200.6807%5C%5C%200.7341%5Cend%7Bsmallmatrix%7D%5Cbigr%29%3D%5Cbigl%28%5Cbegin%7Bsmallmatrix%7D%200.6639%5C%5C%200.6575%20%5Cend%7Bsmallmatrix%7D%5Cbigr%29)          (4-5)

â€‹     æŸå¤±å‡½æ•°ï¼š

â€‹                           ![E(\theta )=\frac{1}{2}(Y-\hat{Y})^T(Y-\hat{Y})=\frac{1}{2}\bigl(\begin{smallmatrix} 0-0.6639\\ 1-0.6757 \end{smallmatrix}\bigr)=0.2796](https://private.codecogs.com/gif.latex?E%28%5Ctheta%20%29%3D%5Cfrac%7B1%7D%7B2%7D%28Y-%5Chat%7BY%7D%29%5ET%28Y-%5Chat%7BY%7D%29%3D%5Cfrac%7B1%7D%7B2%7D%5Cbigl%28%5Cbegin%7Bsmallmatrix%7D%200-0.6639%5C%5C%201-0.6757%20%5Cend%7Bsmallmatrix%7D%5Cbigr%29%3D0.2796)              (4-6)

 3ï¼‰è®¡ç®—è¾“å‡ºå•å…ƒçš„è¯¯å·®é¡¹å’Œéšè—å•å…ƒçš„è¯¯å·®é¡¹

â€‹    **è¾“å‡ºå•å…ƒçš„è¯¯å·®é¡¹ï¼š**æ ¹æ®å…¬å¼(3-19)ï¼Œå°†![Y,\hat{Y},net_{2},h](https://private.codecogs.com/gif.latex?Y%2C%5Chat%7BY%7D%2Cnet_%7B2%7D%2Ch)å¸¦å…¥å…¶ä¸­ï¼Œå¾—åˆ°éœ€æ›´æ–°çš„æ¢¯åº¦è¯¯å·®ï¼š

â€‹                   ![\delta ^{(1)}=\hat{Y}\odot (1-\hat{Y})\odot (\hat{Y}-Y)=\begin{pmatrix} \hat{y}_{1}\\ \hat{y}_{2}\end{pmatrix}\odot \begin{pmatrix} 1-\hat{y}_{1}\\ 1-\hat{y}_{2}\end{pmatrix}\odot \begin{pmatrix} \hat{y}_{1}-y_{1}\\ \hat{y}_{2}-y_{2} \end{pmatrix}](https://private.codecogs.com/gif.latex?%5Cdelta%20%5E%7B%281%29%7D%3D%5Chat%7BY%7D%5Codot%20%281-%5Chat%7BY%7D%29%5Codot%20%28%5Chat%7BY%7D-Y%29%3D%5Cbegin%7Bpmatrix%7D%20%5Chat%7By%7D_%7B1%7D%5C%5C%20%5Chat%7By%7D_%7B2%7D%5Cend%7Bpmatrix%7D%5Codot%20%5Cbegin%7Bpmatrix%7D%201-%5Chat%7By%7D_%7B1%7D%5C%5C%201-%5Chat%7By%7D_%7B2%7D%5Cend%7Bpmatrix%7D%5Codot%20%5Cbegin%7Bpmatrix%7D%20%5Chat%7By%7D_%7B1%7D-y_%7B1%7D%5C%5C%20%5Chat%7By%7D_%7B2%7D-y_%7B2%7D%20%5Cend%7Bpmatrix%7D)      

â€‹                       ![=\begin{pmatrix}0.6639\\0.6757 \end{pmatrix}\odot \begin{pmatrix}1-0.6639\\ 1-0.6757\end{pmatrix}\odot \begin{pmatrix}0.6639-0\\ 0.6757-1\end{pmatrix}=\begin{pmatrix} 0.14814\\ -0.07106 \end{pmatrix}](https://private.codecogs.com/gif.latex?%3D%5Cbegin%7Bpmatrix%7D0.6639%5C%5C0.6757%20%5Cend%7Bpmatrix%7D%5Codot%20%5Cbegin%7Bpmatrix%7D1-0.6639%5C%5C%201-0.6757%5Cend%7Bpmatrix%7D%5Codot%20%5Cbegin%7Bpmatrix%7D0.6639-0%5C%5C%200.6757-1%5Cend%7Bpmatrix%7D%3D%5Cbegin%7Bpmatrix%7D%200.14814%5C%5C%20-0.07106%20%5Cend%7Bpmatrix%7D)             

â€‹                   ![\bigtriangledown _{1}v =h\cdot \delta ^{(1)}^T=\begin{pmatrix}0.5331\\ 0.5349\end{pmatrix}\cdot \begin{pmatrix}0.14814\\ -0.07106\end{pmatrix}^{T}=\begin{pmatrix}0.07897 &-0.03788 \\ 0.07924 &-0.03801 \end{pmatrix}](https://private.codecogs.com/gif.latex?%5Cbigtriangledown%20_%7B1%7Dv%20%3Dh%5Ccdot%20%5Cdelta%20%5E%7B%281%29%7D%5ET%3D%5Cbegin%7Bpmatrix%7D0.5331%5C%5C%200.5349%5Cend%7Bpmatrix%7D%5Ccdot%20%5Cbegin%7Bpmatrix%7D0.14814%5C%5C%20-0.07106%5Cend%7Bpmatrix%7D%5E%7BT%7D%3D%5Cbegin%7Bpmatrix%7D0.07897%20%26-0.03788%20%5C%5C%200.07924%20%26-0.03801%20%5Cend%7Bpmatrix%7D)

   å¦‚æœå¯¹vä¸­æ¯ä¸€ä¸ªå…ƒç´ æ±‚åå¯¼ï¼Œæœ‰ï¼š

â€‹                          ![\bigtriangledown _{1}v_{11}=(\hat{y}_{1}-y_{1})(\hat{y}_{1}(1-\hat{y}_{1}))h_{1}=0.07897](https://private.codecogs.com/gif.latex?%5Cbigtriangledown%20_%7B1%7Dv_%7B11%7D%3D%28%5Chat%7By%7D_%7B1%7D-y_%7B1%7D%29%28%5Chat%7By%7D_%7B1%7D%281-%5Chat%7By%7D_%7B1%7D%29%29h_%7B1%7D%3D0.07897)

â€‹                          ![\bigtriangledown _{1}v_{12}=(\hat{y}_{2}-y_{2})(\hat{y}_{2}(1-\hat{y}_{2}))h_{1}=-0.03788](https://private.codecogs.com/gif.latex?%5Cbigtriangledown%20_%7B1%7Dv_%7B12%7D%3D%28%5Chat%7By%7D_%7B2%7D-y_%7B2%7D%29%28%5Chat%7By%7D_%7B2%7D%281-%5Chat%7By%7D_%7B2%7D%29%29h_%7B1%7D%3D-0.03788)

â€‹                          ![\bigtriangledown _{1}v_{21}=(\hat{y}_{1}-y_{1})(\hat{y}_{1}(1-\hat{y}_{1}))h_{2}=0.07924](https://private.codecogs.com/gif.latex?%5Cbigtriangledown%20_%7B1%7Dv_%7B21%7D%3D%28%5Chat%7By%7D_%7B1%7D-y_%7B1%7D%29%28%5Chat%7By%7D_%7B1%7D%281-%5Chat%7By%7D_%7B1%7D%29%29h_%7B2%7D%3D0.07924)

â€‹                          ![\bigtriangledown _{1}v_{22}=(\hat{y}_{2}-y_{2})(\hat{y}_{2}(1-\hat{y}_{2}))h_{2}=-0.03801](https://private.codecogs.com/gif.latex?%5Cbigtriangledown%20_%7B1%7Dv_%7B22%7D%3D%28%5Chat%7By%7D_%7B2%7D-y_%7B2%7D%29%28%5Chat%7By%7D_%7B2%7D%281-%5Chat%7By%7D_%7B2%7D%29%29h_%7B2%7D%3D-0.03801)

â€‹                               ![\bigtriangledown _{1}v=\begin{pmatrix} 0.07897 &-0.03788 \\ 0.07924&-0.03801 \end{pmatrix}](https://private.codecogs.com/gif.latex?%5Cbigtriangledown%20_%7B1%7Dv%3D%5Cbegin%7Bpmatrix%7D%200.07897%20%26-0.03788%20%5C%5C%200.07924%26-0.03801%20%5Cend%7Bpmatrix%7D)

  ç”¨å…¬å¼(3-19)å’Œå¯¹vä¸­æ¯ä¸€ä¸ªå…ƒç´ æ±‚åå¯¼ï¼Œå¾—åˆ°çš„ç»“æœä¸€è‡´ã€‚

  **éšè—å•å…ƒçš„è¯¯å·®é¡¹**ï¼šæ ¹æ®å…¬å¼(3-23)ï¼Œå°†![\delta ^{(1)},net_{1},h,v,x](https://private.codecogs.com/gif.latex?%5Cdelta%20%5E%7B%281%29%7D%2Cnet_%7B1%7D%2Ch%2Cv%2Cx)å¸¦å…¥å…¶ä¸­ï¼Œå¾—åˆ°éœ€æ›´æ–°çš„æ¢¯åº¦è¯¯å·®

â€‹                ![\bigtriangledown _{1}w=x\cdot (h\odot (1-h)\odot (v\cdot \delta ^{(1)}))^T](https://private.codecogs.com/gif.latex?%5Cbigtriangledown%20_%7B1%7Dw%3Dx%5Ccdot%20%28h%5Codot%20%281-h%29%5Codot%20%28v%5Ccdot%20%5Cdelta%20%5E%7B%281%29%7D%29%29%5ET)

â€‹                    ![=\begin{pmatrix}x_{1}\\ x_{2}\end{pmatrix}\cdot\left ( \begin{pmatrix} h_{1}\\h_{2} \end{pmatrix}\odot \begin{pmatrix}1-h_{1}\\1-h_{2} \end{pmatrix} \odot \left ( \begin{pmatrix}v_{11} &v_{12} \\ v_{21} &v_{22} \end{pmatrix}\cdot \delta ^{(1)} \right )\right )^T](https://private.codecogs.com/gif.latex?%3D%5Cbegin%7Bpmatrix%7Dx_%7B1%7D%5C%5C%20x_%7B2%7D%5Cend%7Bpmatrix%7D%5Ccdot%5Cleft%20%28%20%5Cbegin%7Bpmatrix%7D%20h_%7B1%7D%5C%5Ch_%7B2%7D%20%5Cend%7Bpmatrix%7D%5Codot%20%5Cbegin%7Bpmatrix%7D1-h_%7B1%7D%5C%5C1-h_%7B2%7D%20%5Cend%7Bpmatrix%7D%20%5Codot%20%5Cleft%20%28%20%5Cbegin%7Bpmatrix%7Dv_%7B11%7D%20%26v_%7B12%7D%20%5C%5C%20v_%7B21%7D%20%26v_%7B22%7D%20%5Cend%7Bpmatrix%7D%5Ccdot%20%5Cdelta%20%5E%7B%281%29%7D%20%5Cright%20%29%5Cright%20%29%5ET)

â€‹                    ![=\begin{pmatrix}0.05\\ 0.10\end{pmatrix}\cdot\left ( \begin{pmatrix} 0.5331\\0.5349 \end{pmatrix}\odot \begin{pmatrix}1-0.5331\\1-0.5349 \end{pmatrix} \odot \left ( \begin{pmatrix}0.40 &0.45 \\ 0.50 &0.55\end{pmatrix}\cdot\begin{pmatrix}0.14814\\-0.007106 \end{pmatrix} \right )\right )^T](https://private.codecogs.com/gif.latex?%3D%5Cbegin%7Bpmatrix%7D0.05%5C%5C%200.10%5Cend%7Bpmatrix%7D%5Ccdot%5Cleft%20%28%20%5Cbegin%7Bpmatrix%7D%200.5331%5C%5C0.5349%20%5Cend%7Bpmatrix%7D%5Codot%20%5Cbegin%7Bpmatrix%7D1-0.5331%5C%5C1-0.5349%20%5Cend%7Bpmatrix%7D%20%5Codot%20%5Cleft%20%28%20%5Cbegin%7Bpmatrix%7D0.40%20%260.45%20%5C%5C%200.50%20%260.55%5Cend%7Bpmatrix%7D%5Ccdot%5Cbegin%7Bpmatrix%7D0.14814%5C%5C-0.007106%20%5Cend%7Bpmatrix%7D%20%5Cright%20%29%5Cright%20%29%5ET)

â€‹                    ![=\begin{pmatrix}0.05\\0.10 \end{pmatrix}\cdot \begin{pmatrix}0.02728\\0.03499 \end{pmatrix}^T=\begin{pmatrix} 1.364\times 10^{-3} & 1.750\times 10^{-3}\\ 2.728\times 10^{-3}&3.500\times 10^{-3} \end{pmatrix}](https://private.codecogs.com/gif.latex?%3D%5Cbegin%7Bpmatrix%7D0.05%5C%5C0.10%20%5Cend%7Bpmatrix%7D%5Ccdot%20%5Cbegin%7Bpmatrix%7D0.02728%5C%5C0.03499%20%5Cend%7Bpmatrix%7D%5ET%3D%5Cbegin%7Bpmatrix%7D%201.364%5Ctimes%2010%5E%7B-3%7D%20%26%201.750%5Ctimes%2010%5E%7B-3%7D%5C%5C%202.728%5Ctimes%2010%5E%7B-3%7D%263.500%5Ctimes%2010%5E%7B-3%7D%20%5Cend%7Bpmatrix%7D)

â€‹    è‹¥å¯¹wä¸­æ¯ä¸€ä¸ªå…ƒç´ æ±‚åå¯¼ï¼Œæœ‰ï¼š

â€‹                   ![\bigtriangledown _{1}w_{11}=x_{1}(h_{1}(1-h_{1})v_{11}\delta _{1}^{(1)}+h_{1}(1-h_{1})v_{12}\delta _{2}^{(1)})=1.364\times 10^{-3}](https://private.codecogs.com/gif.latex?%5Cbigtriangledown%20_%7B1%7Dw_%7B11%7D%3Dx_%7B1%7D%28h_%7B1%7D%281-h_%7B1%7D%29v_%7B11%7D%5Cdelta%20_%7B1%7D%5E%7B%281%29%7D&plus;h_%7B1%7D%281-h_%7B1%7D%29v_%7B12%7D%5Cdelta%20_%7B2%7D%5E%7B%281%29%7D%29%3D1.364%5Ctimes%2010%5E%7B-3%7D)

â€‹                   ![\bigtriangledown _{1}w_{12}=x_{1}(h_{2}(1-h_{2})v_{21}\delta _{1}^{(1)}+h_{2}(1-h_{2})v_{22}\delta _{2}^{(1)})=1.750\times 10^{-3}](https://private.codecogs.com/gif.latex?%5Cbigtriangledown%20_%7B1%7Dw_%7B12%7D%3Dx_%7B1%7D%28h_%7B2%7D%281-h_%7B2%7D%29v_%7B21%7D%5Cdelta%20_%7B1%7D%5E%7B%281%29%7D&plus;h_%7B2%7D%281-h_%7B2%7D%29v_%7B22%7D%5Cdelta%20_%7B2%7D%5E%7B%281%29%7D%29%3D1.750%5Ctimes%2010%5E%7B-3%7D)

â€‹                   ![\bigtriangledown _{1}w_{21}=x_{2}(h_{1}(1-h_{1})v_{11}\delta _{1}^{(1)}+h_{1}(1-h_{1})v_{12}\delta _{2}^{(1)})=2.728\times 10^{-3}](https://private.codecogs.com/gif.latex?%5Cbigtriangledown%20_%7B1%7Dw_%7B21%7D%3Dx_%7B2%7D%28h_%7B1%7D%281-h_%7B1%7D%29v_%7B11%7D%5Cdelta%20_%7B1%7D%5E%7B%281%29%7D&plus;h_%7B1%7D%281-h_%7B1%7D%29v_%7B12%7D%5Cdelta%20_%7B2%7D%5E%7B%281%29%7D%29%3D2.728%5Ctimes%2010%5E%7B-3%7D)

â€‹                   ![\bigtriangledown _{1}w_{22}=x_{2}(h_{2}(1-h_{2})v_{21}\delta _{1}^{(1)}+h_{2}(1-h_{2})v_{22}\delta _{2}^{(1)})=3.500\times 10^{-3}](https://private.codecogs.com/gif.latex?%5Cbigtriangledown%20_%7B1%7Dw_%7B22%7D%3Dx_%7B2%7D%28h_%7B2%7D%281-h_%7B2%7D%29v_%7B21%7D%5Cdelta%20_%7B1%7D%5E%7B%281%29%7D&plus;h_%7B2%7D%281-h_%7B2%7D%29v_%7B22%7D%5Cdelta%20_%7B2%7D%5E%7B%281%29%7D%29%3D3.500%5Ctimes%2010%5E%7B-3%7D)

â€‹                      ![\bigtriangledown _{1}w=\begin{pmatrix} \bigtriangledown _{1}w_{11}& \bigtriangledown _{1}w_{12} \\ \bigtriangledown _{1}w_{21}& \bigtriangledown _{1}w_{22} \end{pmatrix}=\begin{pmatrix} 1.364\times 10^{-3} &1.750\times 10^{-3} \\ 2.728\times 10^{-3}&3.500\times 10^{-3} \end{pmatrix}](https://private.codecogs.com/gif.latex?%5Cbigtriangledown%20_%7B1%7Dw%3D%5Cbegin%7Bpmatrix%7D%20%5Cbigtriangledown%20_%7B1%7Dw_%7B11%7D%26%20%5Cbigtriangledown%20_%7B1%7Dw_%7B12%7D%20%5C%5C%20%5Cbigtriangledown%20_%7B1%7Dw_%7B21%7D%26%20%5Cbigtriangledown%20_%7B1%7Dw_%7B22%7D%20%5Cend%7Bpmatrix%7D%3D%5Cbegin%7Bpmatrix%7D%201.364%5Ctimes%2010%5E%7B-3%7D%20%261.750%5Ctimes%2010%5E%7B-3%7D%20%5C%5C%202.728%5Ctimes%2010%5E%7B-3%7D%263.500%5Ctimes%2010%5E%7B-3%7D%20%5Cend%7Bpmatrix%7D)

â€‹    ç”¨å…¬å¼(3-23)å’Œå¯¹vä¸­æ¯ä¸€ä¸ªå…ƒç´ æ±‚åå¯¼ï¼Œå¾—åˆ°çš„ç»“æœä¸€è‡´ã€‚

 **æ³¨æ„ï¼š**ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œä¸ä¼šå¯¹åç½®é¡¹æ›´æ–°

 4ï¼‰æ›´æ–°ç¥ç»ç½‘ç»œä¸­çš„æƒå€¼

â€‹             ![v^{(1)}=v^{(0)}-\eta \ast \bigtriangledown _{1}v=\begin{pmatrix}0.40 &0.45 \\ 0.50 &0.55 \end{pmatrix}-0.5\ast \begin{pmatrix}0.07897 &-0.03788 \\ 0.07924 &-0.03801 \end{pmatrix}](https://private.codecogs.com/gif.latex?v%5E%7B%281%29%7D%3Dv%5E%7B%280%29%7D-%5Ceta%20%5Cast%20%5Cbigtriangledown%20_%7B1%7Dv%3D%5Cbegin%7Bpmatrix%7D0.40%20%260.45%20%5C%5C%200.50%20%260.55%20%5Cend%7Bpmatrix%7D-0.5%5Cast%20%5Cbegin%7Bpmatrix%7D0.07897%20%26-0.03788%20%5C%5C%200.07924%20%26-0.03801%20%5Cend%7Bpmatrix%7D)

â€‹                 ![=\begin{pmatrix}0.36051 &0.46894 \\ 0.46038 &0.56901 \end{pmatrix}](https://private.codecogs.com/gif.latex?%3D%5Cbegin%7Bpmatrix%7D0.36051%20%260.46894%20%5C%5C%200.46038%20%260.56901%20%5Cend%7Bpmatrix%7D)

â€‹            ![w^{(1)}=w^{(0)}-\eta \ast \bigtriangledown _{1}w=\begin{pmatrix}0.15 &0.20\\ 0.25 &0.30 \end{pmatrix}-0.5\ast \begin{pmatrix}1.364\times 10^{-3} &1.750\times 10^{-3} \\ 2.728\times 10^{-3} &3.500\times 10^{-3} \end{pmatrix}](https://private.codecogs.com/gif.latex?w%5E%7B%281%29%7D%3Dw%5E%7B%280%29%7D-%5Ceta%20%5Cast%20%5Cbigtriangledown%20_%7B1%7Dw%3D%5Cbegin%7Bpmatrix%7D0.15%20%260.20%5C%5C%200.25%20%260.30%20%5Cend%7Bpmatrix%7D-0.5%5Cast%20%5Cbegin%7Bpmatrix%7D1.364%5Ctimes%2010%5E%7B-3%7D%20%261.750%5Ctimes%2010%5E%7B-3%7D%20%5C%5C%202.728%5Ctimes%2010%5E%7B-3%7D%20%263.500%5Ctimes%2010%5E%7B-3%7D%20%5Cend%7Bpmatrix%7D)

â€‹                 ![=\begin{pmatrix}0.14983 &0.19978 \\ 0.24966 &0.29956 \end{pmatrix}](https://private.codecogs.com/gif.latex?%3D%5Cbegin%7Bpmatrix%7D0.14983%20%260.19978%20%5C%5C%200.24966%20%260.29956%20%5Cend%7Bpmatrix%7D) 

   äºæ˜¯ï¼Œå¾—åˆ°ç¬¬ä¸€æ¬¡æ›´æ–°çš„å‚æ•°å€¼w,vã€‚

 5ï¼‰é‡å¤æ­¥éª¤2-4ï¼Œç›´åˆ°æŸå¤±å€¼è¾¾åˆ°äº†é¢„å…ˆè®¾å®šçš„é˜ˆå€¼æˆ–è¿­ä»£æ¬¡æ•°ç”¨å®Œï¼Œå¾—åˆ°æœ€ç»ˆçš„æƒå€¼ã€‚

â€‹    ä»¥ä¸Šå³ä¸ºBPç®—æ³•çš„æ›´æ–°æƒå€¼çš„è¿‡ç¨‹ï¼Œä¸‹é¢å°†ä¸Šè¿°å®ä¾‹çš„æ¨å¯¼è¿‡ç¨‹ç”¨ä»£ç å®ç°ï¼š

### **2.5 å®ä¾‹ç¼–ç¨‹å®ç°(è¿è¡Œç¯å¢ƒpython3)**

   æ ¹æ®BPç®—æ³•çš„æ­¥éª¤ï¼Œå°†ä¸Šè¿°ä¾‹å­å¯¹åº”çš„ä»£ç å†™å‡ºå¦‚ä¸‹ï¼š

```python
# encoding:utf-8
# ********* å¯¼å…¥ç›¸åº”çš„æ¨¡å—***********
import math
import numpy as np
from numpy import *
 
#**********è®¾å®šæ¨¡å‹æ‰€éœ€çš„æ¿€æ´»å‡½æ•°ï¼Œè¿è¡Œæ­¤ä»£ç æ—¶ï¼Œå¸¦'*'éƒ¨åˆ†è¯·åˆ é™¤*********
# æ¿€æ´»å‡½æ•°
def sigmoids(z):
    a = []
    for each in z:
        b = 1/(1+math.exp(-each[0]))
        a.append(b)
    return a
 
**********è®¾å®šå‰å‘ä¼ æ’­è¿‡ç¨‹ï¼Œå³æ¨¡å‹çš„è®¾å®šéƒ¨åˆ†ï¼Œæ­¤å¤„å‡æ ¹æ®æ¨¡å‹ç¬¬3éƒ¨åˆ†çš„æ¨¡å‹è®¾å®šéƒ¨åˆ†çš„å…¬å¼ç¼–å†™å¯¹åº”çš„ä»£ç *********
 
# å‰å‘ä¼ æ’­,è¿”å›é¢„æµ‹å€¼
def forwordmd(X,W,V,B1,B2):
    net1 = W.T*X+B1
    H = matrix(sigmoids(np.array(net1))).T # éšè—å±‚å•å…ƒ
    net2 = V.T*H+B2
    pred_y = matrix(sigmoids(np.array(net2))).T # é¢„æµ‹å€¼
    return pred_y,H,net1,net2
 
#**********è®¾å®šæ¨¡å‹åå‘ä¼ æ’­ï¼ŒæŒ‰ç…§æ­¥éª¤4çš„å…¬å¼ç¼–è¾‘*********
# åå‘ä¼ æ’­,æ›´æ–°æƒé‡
def Bpaugorith(Y,pred_y,H,V,aph,W):
    Errorterm = 0.5*(Y-pred_y).T*(Y-pred_y)# ç»™å‡ºè¯¯å·®å…¬å¼
    # è®¡ç®—è¾“å‡ºå•å…ƒçš„è¯¯å·®é¡¹
    a1 = multiply(pred_y-Y,pred_y) # çŸ©é˜µå¯¹åº”å…ƒç´ ç›¸ä¹˜,å³é€å…ƒç´ ç›¸ä¹˜
    a2 = multiply(a1,1-pred_y)
    Verror = H*a2.T
    # è®¡ç®—éšè—å•å…ƒçš„è¯¯å·®é¡¹
    Werror = X*(multiply(multiply(H,1-H),(V*a2))).T
    # æ›´æ–°æƒé‡
    Vupdate = V - aph*Verror
    Wupdate = W - aph*Werror
    return Vupdate,Wupdate,Errorter
 
#**********ä¸»ç¨‹åºéƒ¨åˆ†ï¼Œæ­¤å¤„è®¾å®šäº†æ­¥éª¤1ä¸­çš„å‚æ•°åˆå§‹åŒ–å’Œè¾“å…¥å€¼åŠè¾“å‡ºå€¼çš„çœŸå®å€¼ï¼ŒåŠæ­¥éª¤5ä¸­è®¾ç½®è¿­ä»£æ¬¡æ•°å’Œè®¾ç½®é˜ˆå€¼åœæ­¢è¿­ä»£çš„ä»£ç *********
 
if __name__ =='__main__':
    X = matrix([0.05,0.10]).T
    Y = matrix([0.01,0.99]).T
    # ç»™å‡ºåˆå§‹æƒé‡
    W = matrix([[0.15,0.20],[0.25,0.30]])
    B1 = matrix([0.1,0.1]).T
    V = matrix([[0.40,0.45],[0.50,0.55]])
    B2 = matrix([0.2,0.2]).T
 
    #***********åˆå§‹æƒé‡äº¦å¯éšæœºç”Ÿæˆ***********
    # éšæœºç”Ÿæˆå‚æ•°
    # np.random.seed(0)
    # W = matrix(np.random.normal(0,1,[2,2]))
    # B1 = matrix(np.random.normal(0, 1, [1, 2]))
    # V = matrix(np.random.normal(0, 1, [2, 2]))
    # B2 = matrix(np.random.normal(0, 1, [1, 2]))
    #***********éšæœºç”Ÿæˆå‚æ•°éƒ¨åˆ†ï¼Œè‹¥æœ‰è‡ªå·±è®¾å®šï¼Œå°†æ­¤éƒ¨åˆ†æ³¨é‡Š*********
    aph = 0.5 # å­¦ä¹ ç‡
    #*********ä»æ­¤å¤„ä¸ºè¿­ä»£æ¬¡æ•°è®¾ç½®éƒ¨åˆ†***********
    # è¿­ä»£10æ¬¡
    n = 10 # è¿­ä»£æ¬¡æ•°
    for i in range(n):
        # æ¿€æ´»å‰å‘ç®—æ³•
        pred_y, H,net1,net2 = forwordmd(X,W,V,B1,B2)  # å¾—åˆ°é¢„æµ‹å€¼å’Œéšè—å±‚å€¼
        # æ›´æ–°æƒé‡
        Vupdate, Wupdate,Errorvalue = Bpaugorith(Y,pred_y,H,V,net1,net2,aph,W)  # å¾—åˆ°æ›´æ–°çš„æƒé‡
        W,V = Wupdate,Vupdate
    print ('æŸå¤±å‡½æ•°eï¼š%.2f'%e)
    print ('é¢„æµ‹å€¼ï¼š')
    print (pred_y)
    print ('æ›´æ–°çš„æƒé‡Vï¼š')
    print (Vupdate)
    print ('æ›´æ–°çš„æƒé‡W:')
    print (Wupdate)
    print ('æŸå¤±å€¼ï¼š')
    print (Errorvalue)
 
    # é˜ˆå€¼Eï¼Œå¯æ ¹æ®éœ€è¦è‡ªè¡Œæ›´æ”¹ï¼Œè‹¥éœ€è¦è¿è¡Œæ­¤éƒ¨åˆ†ï¼Œè¯·å°†è¿­ä»£æ¬¡æ•°éƒ¨åˆ†æ³¨é‡Šåè¿è¡Œ
    # é˜ˆå€¼E
    # e,m = 0.19,1
    # pred_y, H, net1, net2 = forwordmd(X,W,V,B1,B2)  # å¾—åˆ°é¢„æµ‹å€¼å’Œéšè—å±‚å€¼
    # æ›´æ–°æƒé‡
    # Vupdate, Wupdate, Errorvalue = Bpaugorith(Y,pred_y,H,V,net1,net2,aph,W)  # å¾—åˆ°æ›´æ–°çš„æƒé‡
    # W,V = Wupdate,Vupdate
    # while Errorvalue>e:
        # æ¿€æ´»å‰å‘ç®—æ³•
        # pred_y, H, net1, net2 = forwordmd(X,W,V,B1,B2)  # å¾—åˆ°é¢„æµ‹å€¼å’Œéšè—å±‚å€¼
        # æ›´æ–°æƒé‡
        # Vupdate, Wupdate, Errorvalue = Bpaugorith(Y,pred_y,H,V,net1,net2,aph,W)  # å¾—åˆ°æ›´æ–°çš„æƒé‡
        # W, V = Wupdate, Vupdate
        # m = m+1
    # print ('è¿­ä»£æ¬¡æ•°ï¼š%d'%n)
    # print ('æ›´æ–°æƒé‡:%dæ¬¡'% m)
    # print ('é¢„æµ‹å€¼ï¼š')
    # print (pred_y)
    # print ('æ›´æ–°çš„æƒé‡Vï¼š')
    # print (Vupdate)
    # print ('æ›´æ–°çš„æƒé‡W:')
    # print (Wupdate)
    # print ('æŸå¤±å€¼ï¼š')
    # print (Errorvalue)
â€‹
 
    #*********é˜ˆå€¼è®¾ç½®éƒ¨åˆ†ç»“æŸ***********
 
â€‹


```



ä»¥ä¸Šéƒ¨åˆ†ä¸ºæœ¬ä¾‹ä¸­çš„ä»£ç éƒ¨åˆ†ã€‚è®¾å®šäº†æ¿€æ´»å‡½æ•°ï¼Œå‰å‘ä¼ æ’­(å³æ¨¡å‹çš„è®¾å®š)åŠåå‘ä¼ æ’­è¿‡ç¨‹ï¼Œæ­¥éª¤5ä¸­æœ‰é˜ˆå€¼è®¾å®šå’Œè¿­ä»£æ­¥æ•°ï¼Œè¿™ä¸€éƒ¨åˆ†çš„ç¨‹åºå¦‚ä¸»ç¨‹åºä¸­ã€‚å‰å‘ä¼ æ’­éƒ¨åˆ†å’Œåå‘ä¼ æ’­éƒ¨åˆ†ï¼Œä»¥ä¸Šå†…å®¹å‡æ ¹æ®æ¨å¯¼çš„å…¬å¼ä¸€å¥å¥ç¼–å†™å‡ºæ¥çš„ã€‚æ„Ÿå…´è¶£çš„æœ‹å‹å¯ä»¥è‡ªå·±å°è¯•ç¼–å†™è¿™éƒ¨åˆ†ç¨‹åºã€‚

[ä»£ç é“¾æ¥](https://gitee.com/someone317/backpropagation_algorithm_test/blob/master/BPtest1.py)

### **2.6 BPç®—æ³•ç¼ºé™·ä¸æ”¹è¿›**

#### 2.6.1  **BPç®—æ³•ç¼ºé™·ï¼š**

1ï¼‰å±€éƒ¨æå°å€¼

å¯¹äºå¤šå±‚ç½‘ç»œï¼Œè¯¯å·®æ›²é¢å¯èƒ½å«æœ‰å¤šä¸ªä¸åŒçš„å±€éƒ¨æå°å€¼ï¼Œæ¢¯åº¦ä¸‹é™å¯èƒ½å¯¼è‡´é™·å…¥å±€éƒ¨æå°å€¼ã€‚

2ï¼‰æƒå€¼è¿‡å¤š

å½“éšè—èŠ‚ç‚¹è¿‡å¤šï¼Œå±‚æ•°è¶Šå¤šæ—¶ï¼Œæƒå€¼æˆå€å¢é•¿ã€‚æƒå€¼çš„å¢é•¿æ„å‘³ç€å¯¹åº”çš„ç©ºé—´ç»´æ•°çš„å¢åŠ ï¼Œè¿‡é«˜çš„ç»´æ•°æ˜“å¯¼è‡´è®­ç»ƒåæœŸçš„è¿‡æ‹Ÿåˆã€‚

3ï¼‰å®¹æ˜“è¿‡æ‹Ÿåˆ

è®­ç»ƒçš„æ¬¡æ•°è¿‡å¤šã€ç©ºé—´ç»´æ•°è¿‡é«˜å‡å®¹æ˜“è¿‡æ‹Ÿåˆã€‚

#### 2.6.2 **BPç®—æ³•æ”¹è¿›ï¼š**

 1ï¼‰åˆ©ç”¨åŠ¨é‡æ³•æ”¹è¿›BPç®—æ³•

åŠ¨é‡æ³•æƒå€¼è°ƒæ•´ç®—æ³•çš„å…·ä½“åšæ³•æ˜¯ï¼šå°†ä¸Šä¸€æ¬¡æƒå€¼è°ƒæ•´é‡çš„ä¸€éƒ¨åˆ†è¿­åŠ åˆ°æŒ‰æœ¬æ¬¡è¯¯å·®è®¡ç®—æ‰€å¾—çš„æƒå€¼è°ƒæ•´é‡ä¸Šï¼Œä½œä¸ºæœ¬æ¬¡çš„å®é™…æƒå€¼è°ƒæ•´é‡ï¼Œå³ï¼š

â€‹                               ![w^{(k)}=\beta w^{(k-1)}-\eta \bigtriangledown _{k}w](https://private.codecogs.com/gif.latex?w%5E%7B%28k%29%7D%3D%5Cbeta%20w%5E%7B%28k-1%29%7D-%5Ceta%20%5Cbigtriangledown%20_%7Bk%7Dw)

å…¶ä¸­ï¼Œ![\beta](https://private.codecogs.com/gif.latex?%5Cbeta)è¡¨ç¤ºåŠ¨é‡ç³»æ•°ï¼Œ![\eta](https://private.codecogs.com/gif.latex?%5Ceta)è¡¨ç¤ºå­¦ä¹ ç‡ã€‚

 

2ï¼‰è‡ªé€‚åº”è°ƒæ•´å­¦ä¹ ç‡

 **è°ƒæ•´çš„åŸºæœ¬æŒ‡å¯¼æ€æƒ³**æ˜¯ï¼šåœ¨å­¦ä¹ æ”¶æ•›çš„æƒ…å†µä¸‹ï¼Œå¢å¤§![\eta](https://private.codecogs.com/gif.latex?%5Ceta)ä»¥ç¼©çŸ­å­¦ä¹ æ—¶é—´ï¼›å½“![\eta](https://private.codecogs.com/gif.latex?%5Ceta)åå¤§è‡´ä½¿ä¸èƒ½æ”¶æ•›æ—¶ï¼Œè¦åŠæ—¶å‡å°å®ƒçš„å€¼ï¼ŒçŸ¥é“æ”¶æ•›ä¸ºæ­¢ã€‚æ­¤æ–¹æ³•é€‚ç”¨äºè®¾ç½®é˜ˆå€¼çš„æƒ…å†µä¸‹ã€‚

 

3ï¼‰åŠ¨é‡-è‡ªé€‚åº”å­¦ä¹ é€Ÿç‡è°ƒæ•´ç®—æ³•

 é‡‡ç”¨åŠ¨é‡æ³•ï¼ŒBPç®—æ³•å¯ä»¥æ‰¾åˆ°æ›´ä¼˜çš„è§£ï¼›é‡‡ç”¨è‡ªé€‚åº”å­¦ä¹ é€Ÿç‡æ³•æ—¶ï¼ŒBPç®—æ³•å¯ä»¥ç¼©çŸ­è®­ç»ƒæ—¶é—´ã€‚å°†ä»¥ä¸Šä¸¤ç§æ–¹æ³•ç»“åˆèµ·æ¥ï¼Œå°±å¾—åˆ°åŠ¨é‡-è‡ªé€‚åº”å­¦ä¹ ç‡è°ƒæ•´ç®—æ³•ã€‚

ä¸Šè¿°2ï¼‰å’Œ3ï¼‰éƒ½é€‚åº”äºè®¾ç½®é˜ˆå€¼æ¥åœæ­¢ç¨‹åºçš„æ–¹æ³•ã€‚
